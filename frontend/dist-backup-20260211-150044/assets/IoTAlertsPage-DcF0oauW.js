import{c as f,r as i,j as e,k as v,T as h}from"./index-DWrA19-Q.js";import{c as k,d as C}from"./iotSensorService-B0uLHwnQ.js";import{A as I}from"./arrow-left-DC_HTBGm.js";import{B as n}from"./bell-Muzov4ul.js";import{R as j}from"./refresh-cw-BhCYe8kh.js";import{C as b}from"./circle-x-CBGg8NKM.js";import{C as N}from"./circle-check-big-CgFKxf-k.js";import{F as A}from"./funnel-DKM2Mrvf.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],p=f("check",R),B=()=>{const[a,m]=i.useState([]),[d,g]=i.useState(!0),[l,r]=i.useState("all"),x=async()=>{try{g(!0);const s=await k();m(s)}catch(s){console.error("알림 조회 실패:",s)}finally{g(!1)}};i.useEffect(()=>{x();const s=setInterval(x,3e4);return()=>clearInterval(s)},[]);const u=async s=>{try{await C(s),m(a.map(c=>c.id===s?{...c,acknowledged:!0}:c))}catch(c){console.error("알림 확인 처리 실패:",c),alert("알림 확인 처리에 실패했습니다")}},o=a.filter(s=>l==="all"?!0:l==="unacknowledged"?!s.acknowledged:s.alert_level===l),t={total:a.length,critical:a.filter(s=>s.alert_level==="CRITICAL").length,warning:a.filter(s=>s.alert_level==="WARNING").length,info:a.filter(s=>s.alert_level==="INFO").length,unacknowledged:a.filter(s=>!s.acknowledged).length},y=s=>{switch(s){case"CRITICAL":return e.jsx(b,{className:"w-5 h-5 text-red-600"});case"WARNING":return e.jsx(h,{className:"w-5 h-5 text-yellow-600"});case"INFO":return e.jsx(N,{className:"w-5 h-5 text-blue-600"});default:return e.jsx(n,{className:"w-5 h-5 text-gray-600"})}},w=s=>{switch(s){case"CRITICAL":return"bg-red-100 text-red-800";case"WARNING":return"bg-yellow-100 text-yellow-800";case"INFO":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(v,{to:"/iot/sensors",className:"p-2 hover:bg-gray-200 rounded-lg transition-colors",children:e.jsx(I,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(n,{className:"w-8 h-8 text-blue-600"}),"알림 센터"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"실시간 알림 모니터링 및 관리"})]})]}),e.jsxs("button",{onClick:x,disabled:d,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[e.jsx(j,{className:`w-4 h-4 ${d?"animate-spin":""}`}),"새로고침"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-gray-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"전체 알림"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:t.total})]}),e.jsx(n,{className:"w-10 h-10 text-gray-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"위험"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:t.critical})]}),e.jsx(b,{className:"w-10 h-10 text-red-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"경고"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:t.warning})]}),e.jsx(h,{className:"w-10 h-10 text-yellow-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"정보"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:t.info})]}),e.jsx(N,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-purple-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"미확인"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:t.unacknowledged})]}),e.jsx(n,{className:"w-10 h-10 text-purple-500"})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-6 p-4",children:e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(A,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"필터:"}),e.jsxs("button",{onClick:()=>r("all"),className:`px-3 py-1 text-sm rounded ${l==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["전체 (",t.total,")"]}),e.jsxs("button",{onClick:()=>r("CRITICAL"),className:`px-3 py-1 text-sm rounded ${l==="CRITICAL"?"bg-red-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["위험 (",t.critical,")"]}),e.jsxs("button",{onClick:()=>r("WARNING"),className:`px-3 py-1 text-sm rounded ${l==="WARNING"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["경고 (",t.warning,")"]}),e.jsxs("button",{onClick:()=>r("INFO"),className:`px-3 py-1 text-sm rounded ${l==="INFO"?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["정보 (",t.info,")"]}),e.jsxs("button",{onClick:()=>r("unacknowledged"),className:`px-3 py-1 text-sm rounded ${l==="unacknowledged"?"bg-purple-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["미확인 (",t.unacknowledged,")"]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["알림 목록 (",o.length,"건)"]})}),d?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(j,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"알림 로딩 중..."})]}):o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(n,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-gray-600",children:"알림이 없습니다"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:l==="all"?"모든 알림이 처리되었습니다":"해당 필터에 맞는 알림이 없습니다"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:o.map(s=>e.jsx("div",{className:`p-6 hover:bg-gray-50 transition-colors ${s.acknowledged?"opacity-60":""}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:y(s.alert_level)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${w(s.alert_level)}`,children:s.alert_level}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.vehicle_id," / ",s.sensor_id]})]}),e.jsx("p",{className:"text-base font-medium text-gray-900",children:s.message})]}),!s.acknowledged&&e.jsxs("button",{onClick:()=>u(s.id),className:"flex items-center gap-1 px-3 py-1.5 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors flex-shrink-0",children:[e.jsx(p,{className:"w-4 h-4"}),"확인"]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsx("span",{children:new Date(s.timestamp).toLocaleString("ko-KR")}),s.acknowledged&&e.jsxs("span",{className:"inline-flex items-center gap-1 text-green-600",children:[e.jsx(p,{className:"w-4 h-4"}),"확인됨"]})]})]})]})},s.id))})]})]})};export{B as default};
