import{r as i,j as e,L as g,B as o,n}from"./index-DWrA19-Q.js";import{m as d}from"./api-S7EUrgPO.js";import{L as h}from"./Layout-_7QmQsM4.js";import{C as r}from"./Card-BZBkuSEa.js";import{R as u}from"./refresh-cw-BhCYe8kh.js";import{U as N}from"./users-CEPVEgfx.js";import{A as f}from"./activity-B0jPijYH.js";import{T as y}from"./trending-up-B_M0jfMY.js";import{S as v}from"./settings-M2ZQNpfd.js";import"./Sidebar-DEFpisEa.js";import"./package-CyltdJ0k.js";import"./calendar-D1aWU6wz.js";import"./message-square-CQX4xtvJ.js";import"./zap-BDAzIdEF.js";import"./dollar-sign-zNa6eeND.js";import"./truck-DYyomFIS.js";import"./thermometer-C21NQbKK.js";import"./chart-column-BBu1zpkI.js";import"./calculator-Cr8S2iSR.js";import"./clock-DDHN8A9u.js";import"./bell-Muzov4ul.js";import"./download-Bm7c4jyO.js";import"./wrench-IdkLiNsk.js";import"./brain-BT-kJAZk.js";import"./x-cTU3yyaH.js";import"./chevron-down-DjioDqHQ.js";import"./index-BvcQtAB6.js";const V=()=>{const[s,p]=i.useState(null),[c,x]=i.useState(!0),[a,m]=i.useState(10),l=async()=>{try{x(!0);const t=await d.getABTestStats();p(t.data),m(t.data.target_rollout_percentage)}catch(t){console.error("Error fetching AB test stats:",t),n.error("AB Test 통계를 불러오는데 실패했습니다")}finally{x(!1)}},j=async()=>{try{await d.updateRollout(a),n.success(`롤아웃 비율이 ${a}%로 업데이트되었습니다`),l()}catch(t){console.error("Error updating rollout:",t),n.error("롤아웃 비율 업데이트에 실패했습니다")}};return i.useEffect(()=>{l();const t=setInterval(l,3e4);return()=>clearInterval(t)},[]),c&&!s?e.jsx(h,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(g,{})})}):e.jsx(h,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AB Test 모니터링"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"ML Dispatch 시스템의 A/B 테스트 현황을 실시간으로 모니터링합니다"})]}),e.jsxs(o,{variant:"outline",onClick:l,disabled:c,children:[e.jsx(u,{className:`w-4 h-4 mr-2 ${c?"animate-spin":""}`}),"새로고침"]})]}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(r,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(N,{className:"w-6 h-6 text-blue-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"총 사용자"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.total_users})]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"p-3 bg-gray-100 rounded-lg",children:e.jsx(f,{className:"w-6 h-6 text-gray-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Control 그룹"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.control_count}),e.jsxs("p",{className:"text-xs text-gray-400",children:[s.total_users>0?(s.control_count/s.total_users*100).toFixed(1):"0.0","%"]})]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(y,{className:"w-6 h-6 text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Treatment 그룹"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.treatment_count}),e.jsxs("p",{className:"text-xs text-gray-400",children:[s.actual_treatment_percentage.toFixed(1),"%"]})]})]})}),e.jsx(r,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(v,{className:"w-6 h-6 text-purple-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"목표 롤아웃"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:[s.target_rollout_percentage,"%"]}),e.jsx("p",{className:"text-xs text-gray-400",children:"설정값"})]})]})})]}),e.jsx(r,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"롤아웃 비율 조정"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Treatment 그룹 비율 (%)"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"range",min:"0",max:"100",step:"10",value:a,onChange:t=>m(Number(t.target.value)),className:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e.jsxs("span",{className:"text-2xl font-semibold text-gray-900 w-16 text-right",children:[a,"%"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["현재: ",s.target_rollout_percentage,"% → 변경: ",a,"%"]}),e.jsx(o,{onClick:j,disabled:a===s.target_rollout_percentage,children:"롤아웃 비율 업데이트"})]})]})]})}),s.stats_cache&&e.jsx(r,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"통계 캐시"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Control Total"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:s.stats_cache.control_total})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Treatment Total"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:s.stats_cache.treatment_total})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Assignments"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:s.stats_cache.total_assignments})]})]})]})}),e.jsxs("div",{className:"text-sm text-gray-500 text-center",children:["마지막 업데이트: ",new Date(s.last_updated).toLocaleString("ko-KR")]})]})]})})};export{V as default};
