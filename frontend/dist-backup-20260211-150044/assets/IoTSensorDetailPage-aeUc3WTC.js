import{f as v,r,j as e,k as g,T as j}from"./index-DWrA19-Q.js";import{b as C}from"./iotSensorService-B0uLHwnQ.js";import{R as x}from"./refresh-cw-BhCYe8kh.js";import{C as d}from"./circle-x-CBGg8NKM.js";import{A as _}from"./arrow-left-DC_HTBGm.js";import{T as m}from"./thermometer-C21NQbKK.js";import{B as T,D as k}from"./droplets-CqJZWQmu.js";import{C as u}from"./circle-check-big-CgFKxf-k.js";import{T as I}from"./trending-up-B_M0jfMY.js";import{T as R}from"./trending-down-CT6h8If0.js";const P=()=>{const{vehicleId:l}=v(),[t,p]=r.useState(null),[c,o]=r.useState(!0),[N,y]=r.useState("24h"),i=async()=>{if(l)try{o(!0);const s=await C(l);p(s)}catch(s){console.error("센서 상세 정보 로딩 실패:",s)}finally{o(!1)}};r.useEffect(()=>{i();const s=setInterval(i,3e4);return()=>clearInterval(s)},[l]);const h=s=>{switch(s){case"normal":return"text-green-600";case"warning":return"text-yellow-600";case"critical":return"text-red-600";default:return"text-gray-600"}},f=s=>{switch(s){case"normal":return e.jsx(u,{className:"w-6 h-6 text-green-600"});case"warning":return e.jsx(j,{className:"w-6 h-6 text-yellow-600"});case"critical":return e.jsx(d,{className:"w-6 h-6 text-red-600"});default:return e.jsx(m,{className:"w-6 h-6 text-gray-600"})}},b=s=>s?s>50?"text-green-600":s>20?"text-yellow-600":"text-red-600":"text-gray-400",w=()=>{if(!t||t.history.length<2)return null;const s=t.history[t.history.length-1],n=t.history[t.history.length-2],a=s.temperature-n.temperature;return Math.abs(a)<.5?null:a>0?e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(I,{className:"w-4 h-4"}),e.jsxs("span",{children:["+",a.toFixed(1),"°C"]})]}):e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsxs("span",{children:[a.toFixed(1),"°C"]})]})};return c?e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(x,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"데이터 로딩 중..."})]})}):t?e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(g,{to:"/iot/sensors",className:"p-2 hover:bg-gray-200 rounded-lg transition-colors",children:e.jsx(_,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[t.vehicle_id," 센서 상세"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["센서 ID: ",t.sensor_id]})]})]}),e.jsxs("button",{onClick:i,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[e.jsx(x,{className:`w-4 h-4 ${c?"animate-spin":""}`}),"새로고침"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"현재 온도"}),e.jsx(m,{className:"w-5 h-5 text-blue-500"})]}),e.jsxs("div",{className:"flex items-end gap-2",children:[e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[t.current_temperature.toFixed(1),"°C"]}),w()]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"배터리"}),e.jsx(T,{className:`w-5 h-5 ${b(t.battery_level)}`})]}),e.jsxs("p",{className:"text-3xl font-bold text-gray-900",children:[t.battery_level||"-","%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"상태"}),f(t.current_status)]}),e.jsx("p",{className:`text-2xl font-bold ${h(t.current_status)}`,children:t.current_status==="normal"?"정상":t.current_status==="warning"?"경고":t.current_status==="critical"?"위험":"알 수 없음"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"마지막 업데이트"}),e.jsx(x,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:new Date(t.last_update).toLocaleString("ko-KR")})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"온도 이력"}),e.jsx("div",{className:"flex gap-2",children:["1h","6h","24h","7d"].map(s=>e.jsx("button",{onClick:()=>y(s),className:`px-3 py-1 text-sm rounded ${N===s?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:s==="1h"?"1시간":s==="6h"?"6시간":s==="24h"?"24시간":"7일"},s))})]}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-xs text-gray-500 uppercase",children:[e.jsx("th",{className:"text-left py-2",children:"시간"}),e.jsx("th",{className:"text-left py-2",children:"온도"}),e.jsx("th",{className:"text-left py-2",children:"습도"}),e.jsx("th",{className:"text-left py-2",children:"배터리"}),e.jsx("th",{className:"text-left py-2",children:"상태"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.history.slice(-20).reverse().map((s,n)=>e.jsxs("tr",{className:"text-sm",children:[e.jsx("td",{className:"py-2 text-gray-600",children:new Date(s.timestamp).toLocaleTimeString("ko-KR")}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"font-medium",children:[s.temperature.toFixed(1),"°C"]})]})}),e.jsx("td",{className:"py-2",children:s.humidity?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4 text-blue-400"}),e.jsxs("span",{children:[s.humidity.toFixed(0),"%"]})]}):"-"}),e.jsx("td",{className:"py-2",children:s.battery_level?`${s.battery_level}%`:"-"}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:`text-xs font-medium ${h(s.status)}`,children:s.status==="normal"?"정상":s.status==="warning"?"경고":s.status==="critical"?"위험":s.status})})]},n))})]})})})]}),t.alerts&&t.alerts.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"알림 이력"})}),e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"space-y-3",children:t.alerts.slice(0,10).map(s=>e.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border ${s.alert_level==="CRITICAL"?"bg-red-50 border-red-200":s.alert_level==="WARNING"?"bg-yellow-50 border-yellow-200":"bg-blue-50 border-blue-200"}`,children:[s.alert_level==="CRITICAL"?e.jsx(d,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}):s.alert_level==="WARNING"?e.jsx(j,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}):e.jsx(u,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(s.timestamp).toLocaleString("ko-KR")})]}),s.acknowledged&&e.jsx("span",{className:"text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded",children:"확인됨"})]},s.id))})})]})]}):e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(d,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-xl text-gray-600",children:"센서 데이터를 찾을 수 없습니다"}),e.jsx(g,{to:"/iot/sensors",className:"mt-4 inline-block text-blue-600 hover:text-blue-800",children:"← 목록으로 돌아가기"})]})})};export{P as default};
