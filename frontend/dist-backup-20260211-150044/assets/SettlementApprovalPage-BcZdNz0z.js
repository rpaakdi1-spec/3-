import{c as b,r,j as e}from"./index-DWrA19-Q.js";import{h as S,i as E,r as A,j as D}from"./billing-enhanced-Dk52PFus.js";import{R as H}from"./refresh-cw-BhCYe8kh.js";import{U as R}from"./user-C9_NANMn.js";import{C as g}from"./clock-DDHN8A9u.js";import{M as I}from"./message-square-CQX4xtvJ.js";import{H as u}from"./history-Ckzns74g.js";import{C as M}from"./circle-alert-BFR813J2.js";import{C as P}from"./circle-x-CBGg8NKM.js";import{C as F}from"./circle-check-big-CgFKxf-k.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}],["path",{d:"M17 14V2",key:"8ymqnk"}]],q=b("thumbs-down",L);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]],K=b("thumbs-up",G),X=()=>{const[m,y]=r.useState([]),[j,l]=r.useState(null),[f,p]=r.useState([]),[o,x]=r.useState(!1),[a,n]=r.useState(""),[N,h]=r.useState(!1);r.useEffect(()=>{c()},[]);const c=async()=>{x(!0);try{const s=await S();y(s)}catch(s){console.error("Failed to load approvals:",s)}finally{x(!1)}},w=async s=>{if(!a.trim()){alert("승인 코멘트를 입력해주세요.");return}try{await E(s,a),alert("정산이 승인되었습니다."),n(""),l(null),c()}catch(t){console.error("Failed to approve:",t),alert("승인에 실패했습니다.")}},v=async s=>{if(!a.trim()){alert("반려 사유를 입력해주세요.");return}try{await A(s,a),alert("정산이 반려되었습니다."),n(""),l(null),c()}catch(t){console.error("Failed to reject:",t),alert("반려에 실패했습니다.")}},C=async s=>{try{const t=await D(s);p(t),h(!0)}catch(t){console.error("Failed to load history:",t)}},k=s=>new Intl.NumberFormat("ko-KR",{style:"currency",currency:"KRW",maximumFractionDigits:0}).format(s),i=s=>new Date(s).toLocaleString("ko-KR"),_=s=>{const t={PENDING:{label:"승인 대기",color:"bg-yellow-100 text-yellow-800",icon:e.jsx(g,{className:"w-4 h-4"})},APPROVED:{label:"승인됨",color:"bg-green-100 text-green-800",icon:e.jsx(F,{className:"w-4 h-4"})},REJECTED:{label:"반려됨",color:"bg-red-100 text-red-800",icon:e.jsx(P,{className:"w-4 h-4"})}},d=t[s]||t.PENDING;return e.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium ${d.color}`,children:[d.icon,d.label]})};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"정산 승인 관리"}),e.jsx("p",{className:"text-gray-600",children:"기사 정산 승인 및 반려 처리"})]}),e.jsxs("button",{onClick:c,disabled:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-400 flex items-center gap-2",children:[e.jsx(H,{className:`w-4 h-4 ${o?"animate-spin":""}`}),"새로고침"]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:m.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:s.settlement_number}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"}),s.driver_name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4"}),i(s.requested_at)]})]})]}),e.jsxs("div",{className:"text-right",children:[_(s.status),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-2",children:k(s.net_amount)})]})]}),s.status==="PENDING"&&e.jsx("div",{className:"border-t border-gray-200 pt-4",children:j===s.settlement_id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:a,onChange:t=>n(t.target.value),placeholder:"승인/반려 코멘트를 입력하세요...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>w(s.settlement_id),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"승인"]}),e.jsxs("button",{onClick:()=>v(s.settlement_id),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center justify-center gap-2",children:[e.jsx(q,{className:"w-4 h-4"}),"반려"]}),e.jsx("button",{onClick:()=>{l(null),n("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"취소"})]})]}):e.jsx("button",{onClick:()=>l(s.settlement_id),className:"w-full px-4 py-2 border-2 border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors font-medium",children:"검토하기"})}),s.status!=="PENDING"&&e.jsx("div",{className:"border-t border-gray-200 pt-4",children:e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(I,{className:"w-4 h-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-600",children:[s.reviewed_by," - ",i(s.reviewed_at)]}),s.comments&&e.jsx("p",{className:"text-gray-900 mt-1",children:s.comments})]})]})}),e.jsx("div",{className:"mt-4",children:e.jsxs("button",{onClick:()=>C(s.settlement_id),className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[e.jsx(u,{className:"w-4 h-4"}),"승인 이력 보기"]})})]},s.id))}),m.length===0&&!o&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[e.jsx(M,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"승인 대기 중인 정산이 없습니다."})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"승인 이력"]}),e.jsx("div",{className:"space-y-4",children:f.map(s=>e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx("span",{className:"font-medium",children:s.performed_by}),e.jsx("span",{children:"•"}),e.jsx("span",{children:i(s.performed_at)})]}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.action}),s.comments&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:s.comments})]},s.id))}),e.jsx("button",{onClick:()=>h(!1),className:"mt-6 w-full px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"닫기"})]})})]})})};export{X as default};
