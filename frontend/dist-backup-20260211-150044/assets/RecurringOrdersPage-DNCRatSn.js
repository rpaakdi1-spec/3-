import{g as C,j as e,r as f,n as o}from"./index-DWrA19-Q.js";const M="/api/v1",j=C.create({baseURL:`${M}/recurring-orders`,timeout:3e4,headers:{"Content-Type":"application/json"}});j.interceptors.request.use(s=>{const d=localStorage.getItem("access_token");return d&&(s.headers.Authorization=`Bearer ${d}`),s},s=>Promise.reject(s));const N={getAll:async s=>(await j.get("/",{params:s})).data,getById:async s=>(await j.get(`/${s}`)).data,create:async s=>(await j.post("/",s)).data,update:async(s,d)=>(await j.put(`/${s}`,d)).data,delete:async s=>{await j.delete(`/${s}`)},toggle:async s=>(await j.post(`/${s}/toggle`)).data,generate:async s=>(await j.post("/generate",null,{params:{target_date:s}})).data,preview:async s=>(await j.get("/preview",{params:{target_date:s}})).data},q=[{value:"DAILY",label:"매일",description:"평일/주말 매일 반복"},{value:"WEEKLY",label:"매주",description:"특정 요일에 반복"},{value:"MONTHLY",label:"매월",description:"특정 날짜에 반복"},{value:"CUSTOM",label:"사용자 지정",description:"특정 날짜 배열"}],W=({value:s,onChange:d,className:p=""})=>e.jsxs("div",{className:`space-y-3 ${p}`,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["반복 주기 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:q.map(a=>e.jsxs("button",{type:"button",onClick:()=>d(a.value),className:`
              relative flex flex-col items-start p-4 border-2 rounded-lg transition-all
              ${s===a.value?"border-indigo-600 bg-indigo-50 shadow-md":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm"}
            `,children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-2",children:[e.jsx("span",{className:`font-semibold ${s===a.value?"text-indigo-700":"text-gray-700"}`,children:a.label}),s===a.value&&e.jsx("svg",{className:"w-5 h-5 text-indigo-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),e.jsx("p",{className:`text-sm ${s===a.value?"text-indigo-600":"text-gray-500"}`,children:a.description})]},a.value))})]}),k=[{label:"월",value:1,fullName:"월요일"},{label:"화",value:2,fullName:"화요일"},{label:"수",value:4,fullName:"수요일"},{label:"목",value:8,fullName:"목요일"},{label:"금",value:16,fullName:"금요일"},{label:"토",value:32,fullName:"토요일"},{label:"일",value:64,fullName:"일요일"}],A=({value:s,onChange:d,className:p=""})=>{const a=c=>{const v=s^c;d(v)},x=c=>(s&c)!==0,r=()=>{d(127)},l=()=>{d(31)},g=()=>{d(96)},y=()=>{d(0)},m=k.filter(c=>x(c.value)).length;return e.jsxs("div",{className:`space-y-3 ${p}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["반복 요일 선택 ",e.jsx("span",{className:"text-red-500",children:"*"}),m>0&&e.jsxs("span",{className:"ml-2 text-xs text-gray-500",children:["(",m,"개 선택됨)"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:l,className:"text-xs text-indigo-600 hover:text-indigo-700 underline",children:"평일"}),e.jsx("button",{type:"button",onClick:g,className:"text-xs text-indigo-600 hover:text-indigo-700 underline",children:"주말"}),e.jsx("button",{type:"button",onClick:r,className:"text-xs text-indigo-600 hover:text-indigo-700 underline",children:"전체"}),e.jsx("button",{type:"button",onClick:y,className:"text-xs text-gray-500 hover:text-gray-700 underline",children:"지우기"})]})]}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:k.map(c=>{const v=x(c.value),t=c.value===32,h=c.value===64;return e.jsx("button",{type:"button",onClick:()=>a(c.value),title:c.fullName,className:`
                flex items-center justify-center h-12 rounded-lg font-medium transition-all
                ${v?h?"bg-red-500 text-white hover:bg-red-600":t?"bg-blue-500 text-white hover:bg-blue-600":"bg-indigo-600 text-white hover:bg-indigo-700":h?"bg-red-50 text-red-400 hover:bg-red-100":t?"bg-blue-50 text-blue-400 hover:bg-blue-100":"bg-gray-100 text-gray-400 hover:bg-gray-200"}
              `,children:c.label},c.value)})}),m===0&&e.jsx("p",{className:"text-sm text-red-500",children:"최소 1개 이상의 요일을 선택해주세요"})]})},T=({initialData:s,clients:d,onSubmit:p,onCancel:a,isLoading:x=!1})=>{const[r,l]=f.useState({name:(s==null?void 0:s.name)||"",frequency:(s==null?void 0:s.frequency)||"WEEKLY",start_date:(s==null?void 0:s.start_date)||new Date().toISOString().split("T")[0],end_date:(s==null?void 0:s.end_date)||"",weekdays:(s==null?void 0:s.weekdays)||31,custom_days:(s==null?void 0:s.custom_days)||"",order_date:(s==null?void 0:s.order_date)||new Date().toISOString().split("T")[0],temperature_zone:(s==null?void 0:s.temperature_zone)||"상온",pickup_client_id:s==null?void 0:s.pickup_client_id,pickup_address:(s==null?void 0:s.pickup_address)||"",pickup_address_detail:(s==null?void 0:s.pickup_address_detail)||"",delivery_client_id:s==null?void 0:s.delivery_client_id,delivery_address:(s==null?void 0:s.delivery_address)||"",delivery_address_detail:(s==null?void 0:s.delivery_address_detail)||"",pallet_count:(s==null?void 0:s.pallet_count)||1,weight_kg:(s==null?void 0:s.weight_kg)||0,volume_cbm:(s==null?void 0:s.volume_cbm)||0,product_name:(s==null?void 0:s.product_name)||"",product_code:(s==null?void 0:s.product_code)||"",pickup_start_time:(s==null?void 0:s.pickup_start_time)||"",pickup_end_time:(s==null?void 0:s.pickup_end_time)||"",delivery_start_time:(s==null?void 0:s.delivery_start_time)||"",delivery_end_time:(s==null?void 0:s.delivery_end_time)||"",is_active:(s==null?void 0:s.is_active)!==void 0?s.is_active:!0}),[g,y]=f.useState(s!=null&&s.pickup_client_id?"client":"address"),[m,c]=f.useState(s!=null&&s.delivery_client_id?"client":"address"),v=async t=>{var _,w;if(t.preventDefault(),!r.name.trim()){o.error("정기 주문 이름을 입력해주세요");return}if(r.frequency==="WEEKLY"&&r.weekdays===0){o.error("최소 1개 이상의 요일을 선택해주세요");return}if((r.frequency==="MONTHLY"||r.frequency==="CUSTOM")&&(!r.custom_days||r.custom_days.trim()==="")){o.error("날짜를 입력해주세요 (예: [1,15,30])");return}if(g==="client"&&!r.pickup_client_id){o.error("상차 거래처를 선택해주세요");return}if(g==="address"&&!((_=r.pickup_address)!=null&&_.trim())){o.error("상차 주소를 입력해주세요");return}if(m==="client"&&!r.delivery_client_id){o.error("하차 거래처를 선택해주세요");return}if(m==="address"&&!((w=r.delivery_address)!=null&&w.trim())){o.error("하차 주소를 입력해주세요");return}if(r.pallet_count<1){o.error("팔레트 수는 최소 1개 이상이어야 합니다");return}const h={...r};g==="client"?(delete h.pickup_address,delete h.pickup_address_detail):delete h.pickup_client_id,m==="client"?(delete h.delivery_address,delete h.delivery_address_detail):delete h.delivery_client_id,await p(h)};return e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"기본 정보"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["정기 주문 이름 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.name,onChange:t=>l({...r,name:t.target.value}),placeholder:"예: 서울-부산 매주 월수금 배송",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsx(W,{value:r.frequency,onChange:t=>l({...r,frequency:t})}),r.frequency==="WEEKLY"&&e.jsx(A,{value:r.weekdays,onChange:t=>l({...r,weekdays:t})}),(r.frequency==="MONTHLY"||r.frequency==="CUSTOM")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["날짜 배열 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.custom_days,onChange:t=>l({...r,custom_days:t.target.value}),placeholder:"[1,15,30] (매월 1일, 15일, 30일)",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JSON 배열 형식으로 입력 (예: [1,15,30])"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["시작일 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:r.start_date,onChange:t=>l({...r,start_date:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"종료일 (선택)"}),e.jsx("input",{type:"date",value:r.end_date,onChange:t=>l({...r,end_date:t.target.value}),min:r.start_date,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"상차 정보"}),e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsx("button",{type:"button",onClick:()=>y("client"),className:`px-4 py-2 rounded-lg font-medium ${g==="client"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"거래처 선택"}),e.jsx("button",{type:"button",onClick:()=>y("address"),className:`px-4 py-2 rounded-lg font-medium ${g==="address"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"주소 직접 입력"})]}),g==="client"?e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["상차 거래처 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.pickup_client_id||"",onChange:t=>l({...r,pickup_client_id:Number(t.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"거래처 선택"}),d.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.address]},t.id))]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["상차 주소 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.pickup_address,onChange:t=>l({...r,pickup_address:t.target.value}),placeholder:"서울시 강남구 테헤란로 123",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상세 주소 (선택)"}),e.jsx("input",{type:"text",value:r.pickup_address_detail,onChange:t=>l({...r,pickup_address_detail:t.target.value}),placeholder:"101동 203호",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"하차 정보"}),e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsx("button",{type:"button",onClick:()=>c("client"),className:`px-4 py-2 rounded-lg font-medium ${m==="client"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"거래처 선택"}),e.jsx("button",{type:"button",onClick:()=>c("address"),className:`px-4 py-2 rounded-lg font-medium ${m==="address"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"주소 직접 입력"})]}),m==="client"?e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["하차 거래처 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.delivery_client_id||"",onChange:t=>l({...r,delivery_client_id:Number(t.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"",children:"거래처 선택"}),d.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.address]},t.id))]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["하차 주소 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.delivery_address,onChange:t=>l({...r,delivery_address:t.target.value}),placeholder:"부산시 해운대구 해운대로 456",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"상세 주소 (선택)"}),e.jsx("input",{type:"text",value:r.delivery_address_detail,onChange:t=>l({...r,delivery_address_detail:t.target.value}),placeholder:"B동 5층",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200 space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"화물 정보"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["온도대 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:r.temperature_zone,onChange:t=>l({...r,temperature_zone:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[e.jsx("option",{value:"냉동",children:"냉동"}),e.jsx("option",{value:"냉장",children:"냉장"}),e.jsx("option",{value:"상온",children:"상온"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["팔레트 수 ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",min:"1",value:r.pallet_count,onChange:t=>l({...r,pallet_count:Number(t.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"중량 (kg)"}),e.jsx("input",{type:"number",min:"0",step:"0.1",value:r.weight_kg,onChange:t=>l({...r,weight_kg:Number(t.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"품목명"}),e.jsx("input",{type:"text",value:r.product_name,onChange:t=>l({...r,product_name:t.target.value}),placeholder:"냉동식품",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"품목코드"}),e.jsx("input",{type:"text",value:r.product_code,onChange:t=>l({...r,product_code:t.target.value}),placeholder:"PROD-001",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:a,disabled:x,className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"취소"}),e.jsx("button",{type:"submit",disabled:x,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:x?"저장 중...":s?"수정":"생성"})]})]})},Y={DAILY:"매일",WEEKLY:"매주",MONTHLY:"매월",CUSTOM:"사용자 지정"},R=["월","화","수","목","금","토","일"],z=s=>{const d=[];return R.forEach((p,a)=>{s&1<<a&&d.push(p)}),d.join(", ")},B=({orders:s,onEdit:d,onDelete:p,onToggle:a,isLoading:x=!1})=>s.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"정기 주문 없음"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"새로운 정기 주문을 생성해보세요"})]}):e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"정기 주문 이름"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"주기"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"경로"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"시작일/종료일"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"마지막 생성"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>a(r.id),disabled:x,className:"flex items-center gap-2 disabled:opacity-50",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${r.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:r.is_active?"활성":"비활성"})})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[r.temperature_zone," · ",r.pallet_count,"팔레트"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:Y[r.frequency]}),r.frequency==="WEEKLY"&&e.jsx("div",{className:"text-xs text-gray-500",children:z(r.weekdays)}),(r.frequency==="MONTHLY"||r.frequency==="CUSTOM")&&r.custom_days&&e.jsx("div",{className:"text-xs text-gray-500 font-mono",children:r.custom_days})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:r.pickup_client_name||r.pickup_address||"미정"}),e.jsx("div",{className:"text-xs text-gray-400",children:"→"}),e.jsx("div",{className:"text-sm text-gray-900",children:r.delivery_client_name||r.delivery_address||"미정"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.jsx("div",{children:r.start_date}),r.end_date&&e.jsxs("div",{children:["~ ",r.end_date]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:r.last_generated_date||"없음"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>d(r),disabled:x,className:"text-indigo-600 hover:text-indigo-900 disabled:opacity-50",title:"수정",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>{window.confirm(`"${r.name}" 정기 주문을 삭제하시겠습니까?`)&&p(r.id)},disabled:x,className:"text-red-600 hover:text-red-900 disabled:opacity-50",title:"삭제",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},r.id))})]})})}),F="/api/v1",I=()=>{const[s,d]=f.useState([]),[p,a]=f.useState([]),[x,r]=f.useState(!1),[l,g]=f.useState(!1),[y,m]=f.useState(null),[c,v]=f.useState("all");f.useEffect(()=>{t(),h()},[c]);const t=async()=>{try{r(!0);const n={};c==="active"&&(n.is_active=!0),c==="inactive"&&(n.is_active=!1);const i=await N.getAll(n);d(i.items)}catch(n){console.error("정기 주문 로드 실패:",n),o.error("정기 주문 목록을 불러올 수 없습니다")}finally{r(!1)}},h=async()=>{try{const n=await C.get(`${F}/clients/`,{params:{is_active:!0}});a(n.data.items||[])}catch(n){console.error("거래처 로드 실패:",n)}},_=async n=>{var i,u;try{r(!0),await N.create(n),o.success("정기 주문이 생성되었습니다"),g(!1),t()}catch(b){console.error("정기 주문 생성 실패:",b),o.error(((u=(i=b.response)==null?void 0:i.data)==null?void 0:u.detail)||"정기 주문 생성에 실패했습니다")}finally{r(!1)}},w=async n=>{var i,u;if(y)try{r(!0),await N.update(y.id,n),o.success("정기 주문이 수정되었습니다"),m(null),g(!1),t()}catch(b){console.error("정기 주문 수정 실패:",b),o.error(((u=(i=b.response)==null?void 0:i.data)==null?void 0:u.detail)||"정기 주문 수정에 실패했습니다")}finally{r(!1)}},S=async n=>{var i,u;try{r(!0),await N.delete(n),o.success("정기 주문이 삭제되었습니다"),t()}catch(b){console.error("정기 주문 삭제 실패:",b),o.error(((u=(i=b.response)==null?void 0:i.data)==null?void 0:u.detail)||"정기 주문 삭제에 실패했습니다")}finally{r(!1)}},L=async n=>{var i,u;try{r(!0),await N.toggle(n),o.success("정기 주문 상태가 변경되었습니다"),t()}catch(b){console.error("정기 주문 토글 실패:",b),o.error(((u=(i=b.response)==null?void 0:i.data)==null?void 0:u.detail)||"상태 변경에 실패했습니다")}finally{r(!1)}},E=n=>{m(n),g(!0)},O=()=>{g(!1),m(null)},$=async()=>{var n,i;if(window.confirm("오늘 생성될 정기 주문들을 즉시 생성하시겠습니까?"))try{r(!0);const u=await N.generate();o.success(`${u.generated}개의 주문이 생성되었습니다`),u.failed>0&&o.error(`${u.failed}개의 주문 생성에 실패했습니다`)}catch(u){console.error("주문 생성 실패:",u),o.error(((i=(n=u.response)==null?void 0:n.data)==null?void 0:i.detail)||"주문 생성에 실패했습니다")}finally{r(!1)}};return e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"정기 주문 관리"}),e.jsx("p",{className:"text-gray-600",children:"자동으로 반복 생성될 주문을 관리합니다. 매일 오전 6시에 자동 실행됩니다."})]}),!l&&e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>v("all"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="all"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:["전체 (",s.length,")"]}),e.jsx("button",{onClick:()=>v("active"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="active"?"bg-green-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"활성"}),e.jsx("button",{onClick:()=>v("inactive"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c==="inactive"?"bg-gray-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"비활성"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:$,disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"즉시 생성"]}),e.jsxs("button",{onClick:()=>{m(null),g(!0)},disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"정기 주문 생성"]})]})]}),l&&e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-6",children:y?"정기 주문 수정":"새 정기 주문 생성"}),e.jsx(T,{initialData:y||void 0,clients:p,onSubmit:y?w:_,onCancel:O,isLoading:x})]})}),!l&&e.jsx(e.Fragment,{children:x&&s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]}):e.jsx(B,{orders:s,onEdit:E,onDelete:S,onToggle:L,isLoading:x})}),!l&&s.length>0&&e.jsx("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"자동 생성 안내"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["정기 주문은 ",e.jsx("strong",{children:"매일 오전 6시"}),'에 자동으로 실행됩니다. "즉시 생성" 버튼으로 수동 실행도 가능합니다.']})]})]})})]})};export{I as RecurringOrdersPage,I as default};
