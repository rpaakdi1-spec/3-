import{c as b,r as n,b as i,j as e,T as x}from"./index-DWrA19-Q.js";import{D as A,B as D,C as L,a as T,b as P,f as $,P as F,c as B,A as U,p as W,d as I,e as O}from"./index-8f5neQgV.js";import{C as z}from"./chart-column-BBu1zpkI.js";import{R as Z}from"./refresh-cw-BhCYe8kh.js";import{T as q}from"./trending-up-B_M0jfMY.js";import{C as m}from"./chevron-down-DjioDqHQ.js";import{D as u}from"./download-Bm7c4jyO.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],h=b("award",G);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],p=b("chevron-up",H);L.register(T,P,$,F,B,U,W,I,O);const ee=()=>{const[t,y]=n.useState(null),[d,N]=n.useState([]),[f,w]=n.useState([]),[r,v]=n.useState(7),[_,g]=n.useState(!0),[c,C]=n.useState("summary");n.useEffect(()=>{j()},[r]);const j=async()=>{try{g(!0);const s=await i.get(`/temperature-analytics/analytics-summary?days=${r}`);y(s.data);const l=await i.get(`/temperature-analytics/top-performers?days=${r}&limit=5`);N(l.data.top_performers);const a=await i.get(`/temperature-analytics/worst-performers?days=${r}&limit=5`);w(a.data.worst_performers)}catch(s){console.error("Failed to load analytics:",s)}finally{g(!1)}},k=async()=>{try{const s=await i.get(`/temperature-analytics/export/compliance-report?days=${r}`,{responseType:"blob"}),l=window.URL.createObjectURL(new Blob([s.data])),a=document.createElement("a");a.href=l,a.setAttribute("download",`compliance_report_${r}days.xlsx`),document.body.appendChild(a),a.click(),a.remove()}catch(s){console.error("Failed to download report:",s),alert("Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.")}},R=async()=>{try{const s=await i.get(`/temperature-analytics/export/performance-report?days=${r}`,{responseType:"blob"}),l=window.URL.createObjectURL(new Blob([s.data])),a=document.createElement("a");a.href=l,a.setAttribute("download",`performance_report_${r}days.xlsx`),document.body.appendChild(a),a.click(),a.remove()}catch(s){console.error("Failed to download report:",s),alert("Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìúÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§.")}},o=s=>{C(c===s?null:s)};if(_||!t)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const S={labels:["Ï§ÄÏàò","ÏúÑÎ∞ò"],datasets:[{data:[t.compliance.rate,100-t.compliance.rate],backgroundColor:["#10b981","#ef4444"],borderWidth:0}]},E={labels:d.map(s=>s.vehicle_number),datasets:[{label:"ÏÑ±Îä• Ï†êÏàò",data:d.map(s=>s.score),backgroundColor:"rgba(59, 130, 246, 0.6)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2}]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(z,{className:"w-8 h-8 text-blue-600"}),"Ïò®ÎèÑ Î∂ÑÏÑù ÎåÄÏãúÎ≥¥Îìú"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Í≥†Í∏â Ïò®ÎèÑ Î∂ÑÏÑù Î∞è ÏÑ±Îä• Î¶¨Ìè¨Ìä∏"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:r,onChange:s=>v(parseInt(s.target.value)),className:"border border-gray-300 rounded-lg px-4 py-2",children:[e.jsx("option",{value:7,children:"ÏµúÍ∑º 7Ïùº"}),e.jsx("option",{value:14,children:"ÏµúÍ∑º 14Ïùº"}),e.jsx("option",{value:30,children:"ÏµúÍ∑º 30Ïùº"}),e.jsx("option",{value:90,children:"ÏµúÍ∑º 90Ïùº"})]}),e.jsxs("button",{onClick:j,className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"ÏÉàÎ°úÍ≥†Ïπ®"]})]})]}),e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-700 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold",children:t.overall_grade}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Ï†ÑÎ∞òÏ†ÅÏù∏ Ïò®ÎèÑ Í¥ÄÎ¶¨ Îì±Í∏â"})]}),e.jsx(h,{className:"w-16 h-16 text-blue-200"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Ï§ÄÏàòÏú®"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600 mt-1",children:[t.compliance.rate.toFixed(1),"%"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.compliance.total_records.toLocaleString()," Í±¥"]})]}),e.jsx(q,{className:"w-8 h-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ÌèâÍ∑† ÏÑ±Îä• Ï†êÏàò"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:[t.performance.avg_score.toFixed(1),"Ï†ê"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[t.performance.scored_vehicles,"ÎåÄ / ",t.performance.total_vehicles,"ÎåÄ"]})]}),e.jsx(h,{className:"w-8 h-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ÏúÑÎ∞ò Ï∞®Îüâ"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:[t.fleet_status.violation_vehicles,"ÎåÄ"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ï†ÑÏ≤¥ ",t.fleet_status.normal_vehicles+t.fleet_status.violation_vehicles,"ÎåÄ"]})]}),e.jsx(x,{className:"w-8 h-8 text-orange-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Critical ÏïåÎ¶º"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600 mt-1",children:[t.fleet_status.critical_alerts,"Í±¥"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Ï†ÑÏ≤¥ ",t.fleet_status.total_alerts,"Í±¥"]})]}),e.jsx(x,{className:"w-8 h-8 text-red-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>o("insights"),children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Ï£ºÏöî Ïù∏ÏÇ¨Ïù¥Ìä∏"}),c==="insights"?e.jsx(p,{}):e.jsx(m,{})]}),c==="insights"&&e.jsx("div",{className:"mt-4 space-y-2",children:t.key_insights.map((s,l)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-lg mt-0.5",children:s.startsWith("‚úÖ")?"‚úÖ":s.startsWith("‚ö†Ô∏è")?"‚ö†Ô∏è":s.startsWith("üö®")?"üö®":"üìä"}),e.jsx("p",{className:"text-sm text-gray-700",children:s})]},l))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Ï§ÄÏàòÏú® ÌòÑÌô©"}),e.jsx("div",{style:{height:"300px"},className:"flex items-center justify-center",children:e.jsx(A,{data:S,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"}}}})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Ïö∞Ïàò Ï∞®Îüâ ÏÑ±Îä•"}),e.jsx("div",{style:{height:"300px"},children:e.jsx(D,{data:E,options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,max:100}},plugins:{legend:{display:!1}}}})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>o("top"),children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5 text-yellow-500"}),"Ïö∞Ïàò Ï∞®Îüâ (Top 5)"]}),c==="top"?e.jsx(p,{}):e.jsx(m,{})]}),c==="top"&&e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-4",children:"ÏàúÏúÑ"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Ï∞®Îüâ Î≤àÌò∏"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Ï†êÏàò"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Îì±Í∏â"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Í∂åÏû•ÏÇ¨Ìï≠"})]})}),e.jsx("tbody",{children:d.map((s,l)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsxs("td",{className:"py-3 px-4 font-bold text-lg",children:["#",l+1]}),e.jsx("td",{className:"py-3 px-4 font-medium",children:s.vehicle_number}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-800 rounded-full font-semibold",children:[s.score.toFixed(1),"Ï†ê"]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full",children:s.grade})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:s.recommendations[0]})]},s.vehicle_id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>o("worst"),children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5 text-red-500"}),"Í∞úÏÑ† ÌïÑÏöî Ï∞®Îüâ (Bottom 5)"]}),c==="worst"?e.jsx(p,{}):e.jsx(m,{})]}),c==="worst"&&e.jsx("div",{className:"mt-4 overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2 px-4",children:"ÏàúÏúÑ"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Ï∞®Îüâ Î≤àÌò∏"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Ï†êÏàò"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Îì±Í∏â"}),e.jsx("th",{className:"text-left py-2 px-4",children:"Í∞úÏÑ† Í∂åÏû•ÏÇ¨Ìï≠"})]})}),e.jsx("tbody",{children:f.map((s,l)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsxs("td",{className:"py-3 px-4 font-bold text-lg text-red-600",children:["#",l+1]}),e.jsx("td",{className:"py-3 px-4 font-medium",children:s.vehicle_number}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-800 rounded-full font-semibold",children:[s.score.toFixed(1),"Ï†ê"]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"px-3 py-1 bg-gray-100 text-gray-800 rounded-full",children:s.grade})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:s.recommendations[0]})]},s.vehicle_id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Î≥¥Í≥†ÏÑú ÎÇ¥Î≥¥ÎÇ¥Í∏∞"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:k,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"Ï§ÄÏàò Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú (Excel)"]}),e.jsxs("button",{onClick:R,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5"}),"ÏÑ±Îä• Î≥¥Í≥†ÏÑú Îã§Ïö¥Î°úÎìú (Excel)"]})]})]})]})};export{ee as default};
