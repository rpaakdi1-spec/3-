import{c as K,r as n,g as A,j as e,T as B}from"./index-DWrA19-Q.js";import{C as b}from"./chart-column-BBu1zpkI.js";import{R as C}from"./refresh-cw-BhCYe8kh.js";import{T as $}from"./trending-up-B_M0jfMY.js";import{U}from"./users-CEPVEgfx.js";import{R as l,o as d,X as c,Y as o,T as i,B as y,r as f,q as E}from"./BarChart-CLbpIxWz.js";import{L as k,a as D}from"./LineChart-07_nQUPD.js";import{P as X,a as O}from"./PieChart-BVQ5u61z.js";import{C as W}from"./circle-x-CBGg8NKM.js";import{C as Y}from"./circle-check-big-CgFKxf-k.js";import{P as q}from"./package-CyltdJ0k.js";import{T}from"./truck-DYyomFIS.js";import{C as z}from"./clock-DDHN8A9u.js";import{D as G}from"./dollar-sign-zNa6eeND.js";import{T as H}from"./trending-down-CT6h8If0.js";import"./string-BbYD24iH.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M5 12h14",key:"1ays0h"}]],Q=K("minus",J);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Z=K("target",V),ee="/api/v1",be=()=>{var N,w,_;const[m,p]=n.useState(!1),[a,F]=n.useState(null),[h,P]=n.useState("last_7_days"),[r,g]=n.useState("overview");n.useEffect(()=>{j()},[h]);const j=async()=>{p(!0);try{const s=localStorage.getItem("access_token"),t=await A.get(`${ee}/analytics/dashboard`,{headers:{Authorization:`Bearer ${s}`},params:{period:h}});F(t.data)}catch(s){console.error("Failed to load dashboard:",s)}finally{p(!1)}},S=s=>{switch(s){case"good":return e.jsx(Y,{className:"w-5 h-5 text-green-500"});case"warning":return e.jsx(B,{className:"w-5 h-5 text-yellow-500"});case"critical":return e.jsx(W,{className:"w-5 h-5 text-red-500"});default:return null}},I=s=>{switch(s){case"good":return"bg-green-50 border-green-200";case"warning":return"bg-yellow-50 border-yellow-200";case"critical":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}},L=(s,t)=>s==="up"?e.jsx($,{className:`w-4 h-4 ${t>0?"text-green-600":"text-red-600"}`}):s==="down"?e.jsx(H,{className:`w-4 h-4 ${t<0?"text-red-600":"text-green-600"}`}):e.jsx(Q,{className:"w-4 h-4 text-gray-600"}),M=s=>s.includes("ì£¼ë¬¸")?e.jsx(q,{className:"w-6 h-6"}):s.includes("ë°°ì†¡")?e.jsx(T,{className:"w-6 h-6"}):s.includes("ì°¨ëŸ‰")?e.jsx(T,{className:"w-6 h-6"}):s.includes("ì‹œê°„")?e.jsx(z,{className:"w-6 h-6"}):s.includes("ë§¤ì¶œ")||s.includes("ê¸ˆì•¡")?e.jsx(G,{className:"w-6 h-6"}):e.jsx(Z,{className:"w-6 h-6"}),x=s=>s.labels.map((t,u)=>({name:t,value:s.values[u]})),R=s=>s.map(t=>({name:`${t.hour}ì‹œ`,count:t.count})),v=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#14b8a6","#f97316"];return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(b,{className:"w-8 h-8 text-blue-600"}),"ê³ ê¸‰ ë¶„ì„ & BI ëŒ€ì‹œë³´ë“œ"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"ì‹¤ì‹œê°„ KPI ëª¨ë‹ˆí„°ë§ ë° íŠ¸ë Œë“œ ë¶„ì„"})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("select",{value:h,onChange:s=>P(s.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"today",children:"ì˜¤ëŠ˜"}),e.jsx("option",{value:"yesterday",children:"ì–´ì œ"}),e.jsx("option",{value:"last_7_days",children:"ìµœê·¼ 7ì¼"}),e.jsx("option",{value:"last_30_days",children:"ìµœê·¼ 30ì¼"}),e.jsx("option",{value:"this_week",children:"ì´ë²ˆ ì£¼"}),e.jsx("option",{value:"this_month",children:"ì´ë²ˆ ë‹¬"}),e.jsx("option",{value:"last_month",children:"ì§€ë‚œ ë‹¬"})]}),e.jsxs("button",{onClick:j,disabled:m,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 disabled:bg-gray-400",children:[e.jsx(C,{className:`w-4 h-4 ${m?"animate-spin":""}`}),"ìƒˆë¡œê³ ì¹¨"]})]})]})}),m&&!a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(C,{className:"w-12 h-12 text-gray-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"ë°ì´í„° ë¡œë”© ì¤‘..."})]}):a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:a.kpis.map((s,t)=>e.jsxs("div",{className:`border rounded-lg p-6 transition-all hover:shadow-lg ${I(s.status)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:"text-gray-700",children:M(s.name)}),S(s.status)]}),e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:s.name}),e.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[e.jsx("span",{className:"text-3xl font-bold text-gray-900",children:s.value.toLocaleString()}),e.jsx("span",{className:"text-sm text-gray-600",children:s.unit})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[L(s.trend,s.change),e.jsxs("span",{className:s.change>=0?"text-green-600":"text-red-600",children:[s.change>0?"+":"",s.change.toFixed(1),"%"]})]}),e.jsxs("span",{className:"text-gray-500",children:["ëª©í‘œ: ",s.target,s.unit]})]})]},t))}),e.jsxs("div",{className:"bg-white rounded-lg shadow mb-6",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"flex gap-4 px-6",children:[e.jsxs("button",{onClick:()=>g("overview"),className:`py-4 px-2 border-b-2 font-medium text-sm transition-colors ${r==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(b,{className:"w-4 h-4 inline mr-2"}),"ê°œìš”"]}),e.jsxs("button",{onClick:()=>g("trends"),className:`py-4 px-2 border-b-2 font-medium text-sm transition-colors ${r==="trends"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx($,{className:"w-4 h-4 inline mr-2"}),"íŠ¸ë Œë“œ"]}),e.jsxs("button",{onClick:()=>g("clients"),className:`py-4 px-2 border-b-2 font-medium text-sm transition-colors ${r==="clients"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(U,{className:"w-4 h-4 inline mr-2"}),"ê³ ê° ë¶„ì„"]})]})}),e.jsxs("div",{className:"p-6",children:[r==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ë§¤ì¶œ ì¶”ì´ (ìµœê·¼ 30ì¼)"}),e.jsx(l,{width:"100%",height:250,children:e.jsxs(k,{data:x(a.revenue_trend),children:[e.jsx(d,{strokeDasharray:"3 3"}),e.jsx(c,{dataKey:"name"}),e.jsx(o,{}),e.jsx(i,{formatter:s=>`${s.toFixed(1)}Mì›`}),e.jsx(D,{type:"monotone",dataKey:"value",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ì£¼ë¬¸ ì¶”ì´ (ìµœê·¼ 30ì¼)"}),e.jsx(l,{width:"100%",height:250,children:e.jsxs(k,{data:x(a.order_trend),children:[e.jsx(d,{strokeDasharray:"3 3"}),e.jsx(c,{dataKey:"name"}),e.jsx(o,{}),e.jsx(i,{formatter:s=>`${s}ê±´`}),e.jsx(D,{type:"monotone",dataKey:"value",stroke:"#10b981",strokeWidth:2,dot:{fill:"#10b981",r:4},activeDot:{r:6}})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ì‹œê°„ëŒ€ë³„ ì£¼ë¬¸ ë¶„í¬"}),e.jsx(l,{width:"100%",height:300,children:e.jsxs(y,{data:R(a.hourly_distribution),children:[e.jsx(d,{strokeDasharray:"3 3"}),e.jsx(c,{dataKey:"name"}),e.jsx(o,{}),e.jsx(i,{}),e.jsx(f,{dataKey:"count",fill:"#8b5cf6"})]})})]})]}),r==="trends"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ë§¤ì¶œ ë¶„ì„"}),e.jsx(l,{width:"100%",height:300,children:e.jsxs(y,{data:x(a.revenue_trend),children:[e.jsx(d,{strokeDasharray:"3 3"}),e.jsx(c,{dataKey:"name"}),e.jsx(o,{}),e.jsx(i,{formatter:s=>`${s.toFixed(1)}Mì›`}),e.jsx(f,{dataKey:"value",fill:"#3b82f6"})]})})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ì£¼ë¬¸ëŸ‰ ë¶„ì„"}),e.jsx(l,{width:"100%",height:300,children:e.jsxs(y,{data:x(a.order_trend),children:[e.jsx(d,{strokeDasharray:"3 3"}),e.jsx(c,{dataKey:"name"}),e.jsx(o,{}),e.jsx(i,{formatter:s=>`${s}ê±´`}),e.jsx(f,{dataKey:"value",fill:"#10b981"})]})})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"ğŸ“Š íŠ¸ë Œë“œ ì¸ì‚¬ì´íŠ¸"}),e.jsxs("ul",{className:"space-y-2 text-blue-800",children:[e.jsxs("li",{children:["â€¢ ìµœê·¼ 7ì¼ê°„ ë§¤ì¶œì´ í‰ê·  ëŒ€ë¹„ ",(N=a.kpis.find(s=>s.name.includes("ë§¤ì¶œ")))==null?void 0:N.change.toFixed(1),"% ì¦ê°€í–ˆìŠµë‹ˆë‹¤"]}),e.jsxs("li",{children:["â€¢ ì£¼ë¬¸ëŸ‰ì´ ì „ ê¸°ê°„ ëŒ€ë¹„ ",(w=a.kpis.find(s=>s.name.includes("ì£¼ë¬¸")))==null?void 0:w.change.toFixed(0),"ê±´ ì¦ê°€í–ˆìŠµë‹ˆë‹¤"]}),e.jsxs("li",{children:["â€¢ ì°¨ëŸ‰ ê°€ë™ë¥ ì´ ëª©í‘œì¹˜ë¥¼ ",((_=a.kpis.find(s=>s.name.includes("ê°€ë™ë¥ ")))==null?void 0:_.status)==="good"?"ë‹¬ì„±":"ë¯¸ë‹¬ì„±","í–ˆìŠµë‹ˆë‹¤"]})]})]})]}),r==="clients"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ìƒìœ„ ê³ ê° Top 10"}),e.jsx("div",{className:"space-y-2",children:a.top_clients.map((s,t)=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center font-bold",children:t+1}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:s.client_name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.order_count,"ê±´ ì£¼ë¬¸"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-gray-900",children:["â‚©",(s.total_revenue/1e6).toFixed(1),"M"]}),e.jsx("div",{className:"w-32 bg-gray-200 rounded-full h-2 mt-1",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(s.order_count/Math.max(...a.top_clients.map(u=>u.order_count))*100,100)}%`}})})]})]},s.client_id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"ê³ ê°ë³„ ë§¤ì¶œ ë¹„ì¤‘"}),e.jsx(l,{width:"100%",height:300,children:e.jsxs(X,{children:[e.jsx(O,{data:a.top_clients.slice(0,8).map(s=>({name:s.client_name,value:s.total_revenue})),cx:"50%",cy:"50%",labelLine:!1,label:({name:s,percent:t})=>`${s}: ${(t*100).toFixed(0)}%`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:a.top_clients.slice(0,8).map((s,t)=>e.jsx(E,{fill:v[t%v.length]},`cell-${t}`))}),e.jsx(i,{formatter:s=>`â‚©${(s/1e6).toFixed(1)}M`})]})})]})]})]})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[e.jsx(b,{className:"w-20 h-20 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"ë°ì´í„° ì—†ìŒ"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"ì„ íƒí•œ ê¸°ê°„ì— ëŒ€í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("button",{onClick:j,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"ë‹¤ì‹œ ì‹œë„"})]})]})})};export{be as default};
