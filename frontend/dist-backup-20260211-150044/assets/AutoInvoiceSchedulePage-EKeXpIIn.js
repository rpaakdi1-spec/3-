import{c as j,r,j as e}from"./index-DWrA19-Q.js";import{c as N,e as w,u as v,d as _,f as k}from"./billing-enhanced-Dk52PFus.js";import{R as C}from"./refresh-cw-BhCYe8kh.js";import{P as I}from"./play-o5nkavRb.js";import{P as S}from"./plus-Bbj8i8yA.js";import{M}from"./mail-BajueKOj.js";import{C as E}from"./circle-check-big-CgFKxf-k.js";import{T}from"./trash-2-D1AjY7Me.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],D=j("pause",L),$=()=>{const[o,m]=r.useState([]),[i,d]=r.useState(!1),[h,n]=r.useState(!1),[A,F]=r.useState(null),[s,a]=r.useState({client_id:0,billing_cycle:"MONTHLY",billing_day:1,auto_send_email:!0,is_active:!0});r.useEffect(()=>{l()},[]);const l=async()=>{d(!0);try{const t=await N();m(t)}catch(t){console.error("Failed to load schedules:",t)}finally{d(!1)}},u=async()=>{try{await k(s),n(!1),a({client_id:0,billing_cycle:"MONTHLY",billing_day:1,auto_send_email:!0,is_active:!0}),l()}catch(t){console.error("Failed to create schedule:",t),alert("스케줄 생성에 실패했습니다.")}},p=async(t,c)=>{try{await v(t,{is_active:!c}),l()}catch(f){console.error("Failed to toggle schedule:",f)}},g=async t=>{if(confirm("정말 삭제하시겠습니까?"))try{await _(t),l()}catch(c){console.error("Failed to delete schedule:",c)}},y=async()=>{try{await w(),alert("자동 청구서 생성이 완료되었습니다."),l()}catch(t){console.error("Failed to execute:",t),alert("자동 청구서 생성에 실패했습니다.")}},x=t=>t?new Date(t).toLocaleString("ko-KR"):"-",b=t=>({IMMEDIATE:"즉시",WEEKLY:"주간",MONTHLY:"월간",CUSTOM:"사용자 정의"})[t]||t;return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"자동 청구 스케줄 관리"}),e.jsx("p",{className:"text-gray-600",children:"거래처별 자동 청구서 생성 스케줄을 설정합니다"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:l,disabled:i,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors disabled:bg-gray-400 flex items-center gap-2",children:[e.jsx(C,{className:`w-4 h-4 ${i?"animate-spin":""}`}),"새로고침"]}),e.jsxs("button",{onClick:y,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:[e.jsx(I,{className:"w-4 h-4"}),"수동 실행"]}),e.jsxs("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(S,{className:"w-4 h-4"}),"스케줄 추가"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"거래처"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"청구 주기"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"청구일"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"이메일 발송"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"마지막 실행"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"다음 실행"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.client_name}),e.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",t.client_id]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:b(t.billing_cycle)})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[t.billing_day,"일"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.auto_send_email?e.jsxs("span",{className:"flex items-center gap-1 text-sm text-green-600",children:[e.jsx(M,{className:"w-4 h-4"}),"자동"]}):e.jsx("span",{className:"text-sm text-gray-400",children:"수동"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:x(t.last_executed_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:x(t.next_execution_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>p(t.id,t.is_active),className:`flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${t.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:t.is_active?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-3 h-3"}),"활성"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-3 h-3"}),"비활성"]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>g(t.id),className:"text-red-600 hover:text-red-900 ml-2",children:e.jsx(T,{className:"w-4 h-4"})})})]},t.id))})]})}),o.length===0&&!i&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"등록된 자동 청구 스케줄이 없습니다."})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 max-w-md w-full",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"자동 청구 스케줄 추가"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"거래처 ID"}),e.jsx("input",{type:"number",value:s.client_id||"",onChange:t=>a({...s,client_id:parseInt(t.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"청구 주기"}),e.jsxs("select",{value:s.billing_cycle,onChange:t=>a({...s,billing_cycle:t.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"IMMEDIATE",children:"즉시"}),e.jsx("option",{value:"WEEKLY",children:"주간"}),e.jsx("option",{value:"MONTHLY",children:"월간"}),e.jsx("option",{value:"CUSTOM",children:"사용자 정의"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"청구일"}),e.jsx("input",{type:"number",min:"1",max:"31",value:s.billing_day,onChange:t=>a({...s,billing_day:parseInt(t.target.value)||1}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.auto_send_email,onChange:t=>a({...s,auto_send_email:t.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{className:"text-sm text-gray-700",children:"이메일 자동 발송"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:s.is_active,onChange:t=>a({...s,is_active:t.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("label",{className:"text-sm text-gray-700",children:"활성화"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{onClick:()=>n(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"취소"}),e.jsx("button",{onClick:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"생성"})]})]})})]})})};export{$ as default};
