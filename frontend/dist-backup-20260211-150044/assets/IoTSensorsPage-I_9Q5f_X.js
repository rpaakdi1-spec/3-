import{r as s,j as e,k as m,T as n}from"./index-DWrA19-Q.js";import{g as k,a as C}from"./iotSensorService-B0uLHwnQ.js";import{T as i}from"./thermometer-C21NQbKK.js";import{B as D}from"./bell-Muzov4ul.js";import{R as o}from"./refresh-cw-BhCYe8kh.js";import{C as h}from"./circle-check-big-CgFKxf-k.js";import{C as p}from"./circle-x-CBGg8NKM.js";import{D as _,B as I}from"./droplets-CqJZWQmu.js";const P=()=>{const[a,g]=s.useState([]),[r,j]=s.useState({total:0,normal:0,warning:0,critical:0}),[c,d]=s.useState(!0),[y,u]=s.useState(new Date),x=async()=>{try{d(!0);const[t,l]=await Promise.all([k(),C()]);g(t),j(l),u(new Date)}catch(t){console.error("센서 데이터 로딩 실패:",t)}finally{d(!1)}};s.useEffect(()=>{x();const t=setInterval(x,1e4);return()=>clearInterval(t)},[]);const w=t=>{switch(t){case"normal":return"bg-green-100 text-green-800 border-green-300";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"critical":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},N=t=>{switch(t){case"normal":return e.jsx(h,{className:"w-5 h-5 text-green-600"});case"warning":return e.jsx(n,{className:"w-5 h-5 text-yellow-600"});case"critical":return e.jsx(p,{className:"w-5 h-5 text-red-600"});default:return e.jsx(i,{className:"w-5 h-5 text-gray-600"})}},f=t=>{switch(t){case"normal":return"정상";case"warning":return"경고";case"critical":return"위험";default:return"알 수 없음"}},b=t=>t?t>50?"text-green-600":t>20?"text-yellow-600":"text-red-600":"text-gray-400";return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(i,{className:"w-8 h-8 text-blue-600"}),"IoT 센서 모니터링"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"실시간 센서 데이터 모니터링 및 알림 관리"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{to:"/iot/alerts",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(D,{className:"w-4 h-4"}),"알림 센터"]}),e.jsxs("button",{onClick:x,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:[e.jsx(o,{className:`w-4 h-4 ${c?"animate-spin":""}`}),"새로고침"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"전체 센서"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:r.total})]}),e.jsx(i,{className:"w-10 h-10 text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"정상"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:r.normal})]}),e.jsx(h,{className:"w-10 h-10 text-green-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"경고"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600",children:r.warning})]}),e.jsx(n,{className:"w-10 h-10 text-yellow-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"위험"}),e.jsx("p",{className:"text-3xl font-bold text-red-600",children:r.critical})]}),e.jsx(p,{className:"w-10 h-10 text-red-500"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"센서 현황"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["마지막 업데이트: ",y.toLocaleString("ko-KR")]})]}),c?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(o,{className:"w-8 h-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"데이터 로딩 중..."})]}):a.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:"센서 데이터가 없습니다"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"차량 ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"센서 ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"온도"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"습도"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"배터리"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"업데이트 시간"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작업"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.vehicle_id})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:t.sensor_id})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:"w-4 h-4 text-gray-400"}),e.jsxs("span",{className:"text-sm font-medium",children:[t.temperature.toFixed(1),"°C"]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.humidity?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-blue-400"}),e.jsxs("span",{className:"text-sm",children:[t.humidity.toFixed(0),"%"]})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.battery_level?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:`w-4 h-4 ${b(t.battery_level)}`}),e.jsxs("span",{className:"text-sm",children:[t.battery_level,"%"]})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium border ${w(t.status)}`,children:[N(t.status),f(t.status)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.timestamp).toLocaleString("ko-KR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx(m,{to:`/iot/sensors/${t.vehicle_id}`,className:"text-blue-600 hover:text-blue-800 font-medium",children:"상세보기 →"})})]},t.sensor_id))})]})})]}),a.some(t=>t.messages&&t.messages.length>0)&&e.jsxs("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-sm font-medium text-yellow-800 mb-2 flex items-center gap-2",children:[e.jsx(n,{className:"w-4 h-4"}),"활성 알림"]}),e.jsx("ul",{className:"space-y-1",children:a.filter(t=>t.messages&&t.messages.length>0).flatMap(t=>{var l;return(l=t.messages)==null?void 0:l.map((v,S)=>e.jsxs("li",{className:"text-sm text-yellow-700",children:["[",t.vehicle_id," / ",t.sensor_id,"] ",v]},`${t.sensor_id}-${S}`))})})]})]})};export{P as default};
