import{r as y,j as e,B as D,R as T,n as F,u as ge,b as W,z as C,L as je}from"./index-DWrA19-Q.js";import{u as ye,L as Q}from"./Layout-_7QmQsM4.js";import{C as P}from"./Card-BZBkuSEa.js";import{I as S}from"./Input-Bh6Z0vgL.js";import{c as be,o as B}from"./api-S7EUrgPO.js";import{X as fe}from"./x-cTU3yyaH.js";import{u as ve,M as _e}from"./useSpeechRecognition-B5i96Btc.js";import{M as Y}from"./map-pin-BXKaUHvy.js";import{P as V}from"./package-CyltdJ0k.js";import{T as Ne}from"./thermometer-C21NQbKK.js";import{C as H}from"./clock-DDHN8A9u.js";import{Z as we}from"./zap-BDAzIdEF.js";import{F as ke}from"./file-spreadsheet-ChC5M9z1.js";import{U as Ce}from"./upload-DeGKjjpU.js";import{D as Se}from"./download-Bm7c4jyO.js";import{M as De}from"./message-square-CQX4xtvJ.js";import{P as Le}from"./plus-Bbj8i8yA.js";import{S as Oe}from"./search-DqRrbLlx.js";import{C as ee}from"./calendar-D1aWU6wz.js";import{F as Ee}from"./funnel-DKM2Mrvf.js";import{T as te}from"./trash-2-D1AjY7Me.js";import{P as ze}from"./pen-Dcr6KkBI.js";import"./Sidebar-DEFpisEa.js";import"./dollar-sign-zNa6eeND.js";import"./activity-B0jPijYH.js";import"./truck-DYyomFIS.js";import"./chart-column-BBu1zpkI.js";import"./calculator-Cr8S2iSR.js";import"./bell-Muzov4ul.js";import"./wrench-IdkLiNsk.js";import"./brain-BT-kJAZk.js";import"./settings-M2ZQNpfd.js";import"./chevron-down-DjioDqHQ.js";import"./index-BvcQtAB6.js";const Ie=({isOpen:t,onClose:i,onSuccess:n,order:l})=>{const o=()=>new Date().toISOString().split("T")[0],[r,d]=y.useState({order_number:`ORD-${Date.now()}`,order_date:o(),temperature_zone:"",pickup_client_id:"",delivery_client_id:"",pickup_address:"",pickup_address_detail:"",delivery_address:"",delivery_address_detail:"",pallet_count:"",weight_kg:"",pickup_start_time:"09:00",pickup_end_time:"18:00",delivery_start_time:"09:00",delivery_end_time:"18:00",requested_delivery_date:o(),priority:5,notes:""}),[_,N]=y.useState([]),[L,b]=y.useState(!1),[E,f]=y.useState(""),[g,w]=y.useState(!0);y.useEffect(()=>{var a,h,O,m;t&&(c(),l?(d({order_number:l.order_number||"",order_date:l.order_date?new Date(l.order_date).toISOString().split("T")[0]:"",temperature_zone:l.temperature_zone||"",pickup_client_id:((a=l.pickup_client_id)==null?void 0:a.toString())||"",delivery_client_id:((h=l.delivery_client_id)==null?void 0:h.toString())||"",pickup_address:l.pickup_address||"",pickup_address_detail:l.pickup_address_detail||"",delivery_address:l.delivery_address||"",delivery_address_detail:l.delivery_address_detail||"",pallet_count:((O=l.pallet_count)==null?void 0:O.toString())||"",weight_kg:((m=l.weight_kg)==null?void 0:m.toString())||"",pickup_start_time:l.pickup_start_time||"",pickup_end_time:l.pickup_end_time||"",delivery_start_time:l.delivery_start_time||"",delivery_end_time:l.delivery_end_time||"",requested_delivery_date:l.requested_delivery_date?new Date(l.requested_delivery_date).toISOString().split("T")[0]:"",priority:l.priority||5,notes:l.notes||""}),w(!!(l.pickup_client_id||l.delivery_client_id))):x())},[t,l]);const c=async()=>{try{const a=await be.list();N(a.data.items||[])}catch(a){console.error("Failed to fetch clients:",a),N([])}},x=()=>{const a=new Date().toISOString().split("T")[0];d({order_number:`ORD-${Date.now()}`,order_date:a,temperature_zone:"",pickup_client_id:"",delivery_client_id:"",pickup_address:"",pickup_address_detail:"",delivery_address:"",delivery_address_detail:"",pallet_count:"",weight_kg:"",pickup_start_time:"09:00",pickup_end_time:"18:00",delivery_start_time:"09:00",delivery_end_time:"18:00",requested_delivery_date:a,priority:5,notes:""}),f(""),w(!0)},p=async a=>{var h,O;a.preventDefault(),b(!0),f("");try{if(!r.order_number){f("ì£¼ë¬¸ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),b(!1);return}if(!r.order_date){f("ì£¼ë¬¸ì¼ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),b(!1);return}if(!r.temperature_zone){f("ì˜¨ë„ëŒ€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),b(!1);return}if(!r.pallet_count||parseInt(r.pallet_count)<=0){f("íŒ”ë ˆíŠ¸ ìˆ˜ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (1ê°œ ì´ìƒ)"),b(!1);return}if(g){if(!r.pickup_client_id){f("ìƒì°¨ ê±°ë˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),b(!1);return}if(!r.delivery_client_id){f("í•˜ì°¨ ê±°ë˜ì²˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”"),b(!1);return}}else{if(!r.pickup_address){f("ìƒì°¨ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),b(!1);return}if(!r.delivery_address){f("í•˜ì°¨ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"),b(!1);return}}const m={order_number:r.order_number,order_date:r.order_date,temperature_zone:r.temperature_zone,pallet_count:parseInt(r.pallet_count),priority:r.priority};r.weight_kg&&(m.weight_kg=parseFloat(r.weight_kg)),r.pickup_start_time&&(m.pickup_start_time=r.pickup_start_time),r.pickup_end_time&&(m.pickup_end_time=r.pickup_end_time),r.delivery_start_time&&(m.delivery_start_time=r.delivery_start_time),r.delivery_end_time&&(m.delivery_end_time=r.delivery_end_time),r.requested_delivery_date&&(m.requested_delivery_date=r.requested_delivery_date),r.notes&&(m.notes=r.notes),g?(m.pickup_client_id=parseInt(r.pickup_client_id),m.delivery_client_id=parseInt(r.delivery_client_id)):(m.pickup_address=r.pickup_address,m.pickup_address_detail=r.pickup_address_detail,m.delivery_address=r.delivery_address,m.delivery_address_detail=r.delivery_address_detail),console.log("ğŸš€ Submitting order:",m),l?await B.update(l.id,m):await B.create(m),n()}catch(m){console.error("âŒ Order submission error:",m),console.error("âŒ Error response:",m.response);let A="ì£¼ë¬¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.";(O=(h=m.response)==null?void 0:h.data)!=null&&O.detail&&(typeof m.response.data.detail=="string"?A=m.response.data.detail:Array.isArray(m.response.data.detail)&&(A=`ì…ë ¥ ì˜¤ë¥˜:
${m.response.data.detail.map(z=>`${Array.isArray(z.loc)?z.loc.join("."):z.loc}: ${z.msg} (${z.type})`).join(`
`)}`,console.error("ğŸ“‹ Validation errors:",m.response.data.detail))),f(A)}finally{b(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:l?"ì£¼ë¬¸ ìˆ˜ì •":"ìƒˆ ì£¼ë¬¸ ë“±ë¡"}),e.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-700",children:e.jsx(fe,{size:24})})]}),e.jsxs("form",{onSubmit:p,className:"p-6 space-y-6",children:[E&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:E}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"ê¸°ë³¸ ì •ë³´"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(S,{label:"ì£¼ë¬¸ë²ˆí˜¸ *",value:r.order_number,onChange:a=>d({...r,order_number:a.target.value}),placeholder:"ORD-20260130-001",required:!0}),e.jsx(S,{label:"ì£¼ë¬¸ì¼ì *",type:"date",value:r.order_date,onChange:a=>d({...r,order_date:a.target.value}),required:!0}),e.jsx(S,{label:"í¬ë§ ë°°ì†¡ì¼",type:"date",value:r.requested_delivery_date,onChange:a=>d({...r,requested_delivery_date:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ì˜¨ë„ëŒ€ *"}),e.jsxs("select",{value:r.temperature_zone,onChange:a=>d({...r,temperature_zone:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"ì„ íƒ"}),e.jsx("option",{value:"ëƒ‰ë™",children:"ëƒ‰ë™ (-30Â°C ~ -18Â°C)"}),e.jsx("option",{value:"ëƒ‰ì¥",children:"ëƒ‰ì¥ (0Â°C ~ 6Â°C)"}),e.jsx("option",{value:"ìƒì˜¨",children:"ìƒì˜¨"})]})]}),e.jsx(S,{label:"íŒ”ë ˆíŠ¸ ìˆ˜ëŸ‰ *",type:"number",value:r.pallet_count,onChange:a=>d({...r,pallet_count:a.target.value}),min:"1",placeholder:"20",required:!0}),e.jsx(S,{label:"ì¤‘ëŸ‰(kg)",type:"number",value:r.weight_kg,onChange:a=>d({...r,weight_kg:a.target.value}),min:"0",step:"0.1",placeholder:"1000"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ìš°ì„ ìˆœìœ„"}),e.jsxs("select",{value:r.priority,onChange:a=>d({...r,priority:parseInt(a.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"1",children:"ìµœìš°ì„  (1)"}),e.jsx("option",{value:"3",children:"ë†’ìŒ (3)"}),e.jsx("option",{value:"5",children:"ë³´í†µ (5)"}),e.jsx("option",{value:"7",children:"ë‚®ìŒ (7)"}),e.jsx("option",{value:"10",children:"ìµœí•˜ (10)"})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"ìƒì°¨/í•˜ì°¨ ì •ë³´"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>w(!0),className:`px-3 py-1 text-sm rounded ${g?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"ê±°ë˜ì²˜ ì„ íƒ"}),e.jsx("button",{type:"button",onClick:()=>w(!1),className:`px-3 py-1 text-sm rounded ${g?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-blue-500 text-white"}`,children:"ì£¼ì†Œ ì§ì ‘ ì…ë ¥"})]})]}),g?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ìƒì°¨ ê±°ë˜ì²˜ *"}),e.jsxs("select",{value:r.pickup_client_id,onChange:a=>d({...r,pickup_client_id:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:g,children:[e.jsx("option",{value:"",children:"ê±°ë˜ì²˜ ì„ íƒ"}),_.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"í•˜ì°¨ ê±°ë˜ì²˜ *"}),e.jsxs("select",{value:r.delivery_client_id,onChange:a=>d({...r,delivery_client_id:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:g,children:[e.jsx("option",{value:"",children:"ê±°ë˜ì²˜ ì„ íƒ"}),_.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{label:"ìƒì°¨ ì£¼ì†Œ *",value:r.pickup_address,onChange:a=>d({...r,pickup_address:a.target.value}),placeholder:"ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 427",required:!g}),e.jsx(S,{label:"ìƒì°¨ ìƒì„¸ì£¼ì†Œ",value:r.pickup_address_detail,onChange:a=>d({...r,pickup_address_detail:a.target.value}),placeholder:"1ì¸µ"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(S,{label:"í•˜ì°¨ ì£¼ì†Œ *",value:r.delivery_address,onChange:a=>d({...r,delivery_address:a.target.value}),placeholder:"ë¶€ì‚°ì‹œ í•´ìš´ëŒ€êµ¬ ì„¼í…€ì¤‘ì•™ë¡œ 48",required:!g}),e.jsx(S,{label:"í•˜ì°¨ ìƒì„¸ì£¼ì†Œ",value:r.delivery_address_detail,onChange:a=>d({...r,delivery_address_detail:a.target.value}),placeholder:"2ì¸µ ì°½ê³ "})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 border-b pb-2",children:"ìƒì°¨/í•˜ì°¨ ì‹œê°„"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(S,{label:"ìƒì°¨ ì‹œì‘",type:"time",value:r.pickup_start_time,onChange:a=>d({...r,pickup_start_time:a.target.value})}),e.jsx(S,{label:"ìƒì°¨ ì¢…ë£Œ",type:"time",value:r.pickup_end_time,onChange:a=>d({...r,pickup_end_time:a.target.value})}),e.jsx(S,{label:"í•˜ì°¨ ì‹œì‘",type:"time",value:r.delivery_start_time,onChange:a=>d({...r,delivery_start_time:a.target.value})}),e.jsx(S,{label:"í•˜ì°¨ ì¢…ë£Œ",type:"time",value:r.delivery_end_time,onChange:a=>d({...r,delivery_end_time:a.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"íŠ¹ì´ì‚¬í•­"}),e.jsx("textarea",{value:r.notes,onChange:a=>d({...r,notes:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"í™”ë¬¼ ì·¨ê¸‰ ì‹œ ì£¼ì˜ì‚¬í•­ì„ ì…ë ¥í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx(D,{type:"button",variant:"secondary",onClick:i,disabled:L,children:"ì·¨ì†Œ"}),e.jsx(D,{type:"submit",variant:"primary",loading:L,children:l?"ìˆ˜ì •":"ë“±ë¡"})]})]})]})}):null};var le={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},se=T.createContext&&T.createContext(le),Pe=["attr","size","title"];function Te(t,i){if(t==null)return{};var n=Ae(t,i),l,o;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(o=0;o<r.length;o++)l=r[o],!(i.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(t,l)&&(n[l]=t[l])}return n}function Ae(t,i){if(t==null)return{};var n={};for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){if(i.indexOf(l)>=0)continue;n[l]=t[l]}return n}function q(){return q=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var n=arguments[i];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l])}return t},q.apply(this,arguments)}function re(t,i){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);i&&(l=l.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,l)}return n}function G(t){for(var i=1;i<arguments.length;i++){var n=arguments[i]!=null?arguments[i]:{};i%2?re(Object(n),!0).forEach(function(l){$e(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function $e(t,i,n){return i=Re(i),i in t?Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[i]=n,t}function Re(t){var i=Me(t,"string");return typeof i=="symbol"?i:i+""}function Me(t,i){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,i);if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(t)}function ie(t){return t&&t.map((i,n)=>T.createElement(i.tag,G({key:n},i.attr),ie(i.child)))}function U(t){return i=>T.createElement(Fe,q({attr:G({},t.attr)},i),ie(t.child))}function Fe(t){var i=n=>{var{attr:l,size:o,title:r}=t,d=Te(t,Pe),_=o||n.size||"1em",N;return n.className&&(N=n.className),t.className&&(N=(N?N+" ":"")+t.className),T.createElement("svg",q({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,l,d,{className:N,style:G(G({color:t.color||n.color},n.style),t.style),height:_,width:_,xmlns:"http://www.w3.org/2000/svg"}),r&&T.createElement("title",null,r),t.children)};return se!==void 0?T.createElement(se.Consumer,null,n=>i(n)):i(le)}function Be(t){return U({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(t)}function ae(t){return U({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(t)}function qe(t){return U({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(t)}function Ge(t){return U({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(t)}const Ue=()=>{const[t,i]=y.useState(""),[n,l]=y.useState(!1),[o,r]=y.useState(null),[d,_]=y.useState(new Set),N=async()=>{var c,x;if(!t.trim()){alert("ì£¼ë¬¸ í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");return}l(!0);try{const p=await B.parseNLP(t);r(p.data)}catch(p){console.error("NLP íŒŒì‹± ì‹¤íŒ¨:",p),r({success:!1,error:((x=(c=p.response)==null?void 0:c.data)==null?void 0:x.detail)||"íŒŒì‹± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}finally{l(!1)}},L=()=>{i(""),r(null),_(new Set)},b=c=>{const x=new Set(d);x.has(c)?x.delete(c):x.add(c),_(x)},E=()=>{o!=null&&o.orders&&(d.size===o.orders.length?_(new Set):_(new Set(o.orders.map((c,x)=>x))))},f=async()=>{var x,p;if(!(o!=null&&o.orders)||d.size===0){alert("ìƒì„±í•  ì£¼ë¬¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");return}const c=o.orders.filter((a,h)=>d.has(h)).map((a,h)=>({...a,order_number:a.order_number||`NLP-${Date.now()}-${h+1}`,pallet_count:a.pallet_count||1,temperature_zone:a.temperature_zone||"AMBIENT",weight_kg:a.weight_kg||0,volume_cbm:a.volume_cbm||0}));try{l(!0);const a=await Promise.all(c.map(h=>B.create(h)));alert(`${a.length}ê°œì˜ ì£¼ë¬¸ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`),L(),window.location.href="/orders"}catch(a){console.error("ì£¼ë¬¸ ìƒì„± ì‹¤íŒ¨:",a);const h=((p=(x=a.response)==null?void 0:x.data)==null?void 0:p.detail)||a.message||"ì£¼ë¬¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";alert(`ì£¼ë¬¸ ìƒì„± ì‹¤íŒ¨: ${h}`)}finally{l(!1)}},g=c=>c?c>=.9?{label:"ë†’ìŒ",color:"bg-green-100 text-green-700"}:c>=.7?{label:"ë³´í†µ",color:"bg-yellow-100 text-yellow-700"}:{label:"ë‚®ìŒ",color:"bg-red-100 text-red-700"}:{label:"ë¯¸í™•ì¸",color:"bg-gray-100 text-gray-600"},w=c=>c?{FROZEN:"ëƒ‰ë™",REFRIGERATED:"ëƒ‰ì¥",AMBIENT:"ìƒì˜¨"}[c]||c:"-";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"ğŸ“ ìì—°ì–´ ì£¼ë¬¸ ì…ë ¥"}),e.jsx("p",{className:"text-gray-600",children:"ê±°ë˜ì²˜ì—ì„œ ë°›ì€ ì£¼ë¬¸ì„ ê·¸ëŒ€ë¡œ ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ íŒŒì‹±í•©ë‹ˆë‹¤."})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsx("label",{className:"block mb-2 font-semibold",children:"ì£¼ë¬¸ í…ìŠ¤íŠ¸ ì…ë ¥"}),e.jsx("textarea",{value:t,onChange:c=>i(c.target.value),placeholder:`ì˜ˆì‹œ 1:
[02/03] ì¶”ê°€ ë°°ì°¨ìš”ì²­
ë°±ì•” _ ì €ì˜¨ â†’ ê²½ì‚° 16íŒ 1ëŒ€

ì˜ˆì‹œ 2:
**2/3(í™”)ëª©ìš°ì´Œ ì˜¤í›„ë°°ì°¨**
15:30 / ìœ¡ê°€ê³µ5í†¤
16:30 / ìœ¡ê°€ê³µ11í†¤

ì˜ˆì‹œ 3:
ë™ì´ì²œì„¼í„° â†’ ì–‘ì‚° 16íŒ 1ëŒ€`,className:"w-full h-48 p-3 border rounded-md focus:ring-2 focus:ring-blue-500",disabled:n}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsx("button",{onClick:N,disabled:n||!t.trim(),className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"íŒŒì‹± ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx(qe,{}),"íŒŒì‹± ì‹œì‘"]})}),e.jsxs("button",{onClick:L,disabled:n,className:"flex items-center gap-2 px-6 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 disabled:cursor-not-allowed",children:[e.jsx(Ge,{}),"ì´ˆê¸°í™”"]})]})]}),o&&e.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:o.success&&o.orders?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(ae,{className:"text-green-600"}),"íŒŒì‹± ê²°ê³¼: ",o.orders.length,"ê°œ ì£¼ë¬¸"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:E,className:"px-4 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200",children:d.size===o.orders.length?"ì „ì²´ í•´ì œ":"ì „ì²´ ì„ íƒ"}),e.jsxs("button",{onClick:f,disabled:d.size===0||n,className:"px-4 py-2 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx(ae,{}),"ì„ íƒí•œ ì£¼ë¬¸ ìƒì„± (",d.size,")"]})]})]}),e.jsx("div",{className:"space-y-4",children:o.orders.map((c,x)=>{const p=g(c.confidence_score),a=d.has(x);return e.jsxs("div",{className:`border rounded-lg p-4 ${a?"border-blue-500 bg-blue-50":"border-gray-300"}`,children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:a,onChange:()=>b(x),className:"w-5 h-5 cursor-pointer"}),e.jsxs("h4",{className:"font-bold text-lg",children:["ì£¼ë¬¸ #",x+1]}),e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-semibold ${p.color}`,children:["ì‹ ë¢°ë„: ",p.label," ",c.confidence_score?`(${(c.confidence_score*100).toFixed(0)}%)`:""]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"ì£¼ë¬¸ì¼ì:"}),e.jsx("span",{className:"ml-2",children:c.order_date||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"ì˜¨ë„ëŒ€:"}),e.jsx("span",{className:"ml-2",children:w(c.temperature_zone)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"ìƒì°¨ì§€:"}),e.jsx("span",{className:"ml-2",children:c.pickup_client||c.pickup_address||"-"}),c.matched_pickup_client_id&&e.jsx("span",{className:"ml-1 text-xs text-green-600",children:"(ë§¤ì¹­ë¨)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"í•˜ì°¨ì§€:"}),e.jsx("span",{className:"ml-2",children:c.delivery_client||c.delivery_address||"-"}),c.matched_delivery_client_id&&e.jsx("span",{className:"ml-1 text-xs text-green-600",children:"(ë§¤ì¹­ë¨)"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"íŒ”ë ˆíŠ¸:"}),e.jsx("span",{className:"ml-2",children:c.pallet_count||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"ì¤‘ëŸ‰:"}),e.jsx("span",{className:"ml-2",children:c.weight_kg?`${c.weight_kg}kg`:"-"})]}),c.pickup_start_time&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"ìƒì°¨ì‹œê°„:"}),e.jsxs("span",{className:"ml-2",children:[c.pickup_start_time," ~ ",c.pickup_end_time||"-"]})]}),c.delivery_start_time&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"í•˜ì°¨ì‹œê°„:"}),e.jsxs("span",{className:"ml-2",children:[c.delivery_start_time," ~ ",c.delivery_end_time||"-"]})]}),c.product_name&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"ìƒí’ˆëª…:"}),e.jsx("span",{className:"ml-2",children:c.product_name})]}),c.notes&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-semibold text-gray-600",children:"ë©”ëª¨:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:c.notes})]})]})]},x)})})]}):e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 border border-red-200 rounded-md",children:[e.jsx(Be,{className:"text-red-600 text-xl"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-red-800",children:"íŒŒì‹± ì‹¤íŒ¨"}),e.jsx("p",{className:"text-sm text-red-600",children:o.error||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})]})]})}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold mb-2 text-blue-900",children:"ğŸ’¡ ì‚¬ìš© ê°€ì´ë“œ"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"ê±°ë˜ì²˜ì—ì„œ ë°›ì€ ì£¼ë¬¸ í…ìŠ¤íŠ¸ë¥¼ ê·¸ëŒ€ë¡œ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”"}),e.jsx("li",{children:"ë‚ ì§œ, ê±°ë˜ì²˜ëª…, ì˜¨ë„ëŒ€, íŒ”ë ˆíŠ¸ ìˆ˜ ë“±ì´ ìë™ìœ¼ë¡œ ì¸ì‹ë©ë‹ˆë‹¤"}),e.jsx("li",{children:"ì—¬ëŸ¬ ì£¼ë¬¸ì„ í•œ ë²ˆì— ì…ë ¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤"}),e.jsx("li",{children:"íŒŒì‹± ê²°ê³¼ë¥¼ í™•ì¸í•˜ê³  ìˆ˜ì •ì´ í•„ìš”í•œ ê²½ìš° ì£¼ë¬¸ ìƒì„± í›„ ìˆ˜ì •í•˜ì„¸ìš”"}),e.jsx("li",{children:"ì‹ ë¢°ë„ê°€ ë‚®ì€ ê²½ìš°(70% ì´í•˜) ë°˜ë“œì‹œ í™•ì¸ í›„ ìƒì„±í•˜ì„¸ìš”"})]})]})]})},We=({onOrderCreated:t})=>{const{isListening:i,transcript:n,interimTranscript:l,startListening:o,stopListening:r,resetTranscript:d,isSupported:_,error:N}=ve(),[L,b]=y.useState(!1),E=()=>{d(),o(),F.success("ìŒì„± ì¸ì‹ì„ ì‹œì‘í•©ë‹ˆë‹¤. ì£¼ë¬¸ ì •ë³´ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”.")},f=()=>{r(),F.success("ìŒì„± ì¸ì‹ì´ ì¤‘ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.")},g=async()=>{var w,c;if(!n.trim()){F.error("ìŒì„±ìœ¼ë¡œ ì…ë ¥ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.");return}b(!0);try{const x=await B.parseNLP(n);if(!x.orders||x.orders.length===0){F.error("ì£¼ë¬¸ ì •ë³´ë¥¼ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");return}const p=x.orders[0],h=`VOICE-${Date.now()}`,O={order_number:h,order_date:new Date().toISOString().split("T")[0],temperature_zone:p.temperature_zone||"AMBIENT",pickup_address:p.pickup_address||"",delivery_address:p.delivery_address||"",pallet_count:p.pallet_count||1,weight_kg:p.weight_kg||0,volume_cbm:0},m=await B.create(O);F.success(`ìŒì„± ì£¼ë¬¸ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤! (${h})`),d(),t&&t()}catch(x){console.error("Voice order creation failed:",x),F.error(((c=(w=x.response)==null?void 0:w.data)==null?void 0:c.detail)||"ì£¼ë¬¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.")}finally{b(!1)}};return _?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"ìŒì„± ì£¼ë¬¸ ì…ë ¥"}),e.jsx("p",{className:"text-sm text-gray-500",children:"ë§ë¡œ ì£¼ë¬¸ ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”"})]})]}),i&&e.jsxs("span",{className:"flex items-center gap-2 px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium animate-pulse",children:[e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"}),"ë…¹ìŒ ì¤‘..."]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"min-h-[120px] p-4 bg-gray-50 border border-gray-200 rounded-lg",children:n||l?e.jsxs("div",{className:"text-gray-900",children:[e.jsx("p",{className:"whitespace-pre-wrap",children:n}),l&&e.jsx("p",{className:"text-gray-400 italic",children:l})]}):e.jsx("p",{className:"text-gray-400 text-center py-8",children:i?"ìŒì„±ì„ ì¸ì‹í•˜ê³  ìˆìŠµë‹ˆë‹¤...":"ë§ˆì´í¬ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì£¼ë¬¸ ì •ë³´ë¥¼ ë§ì”€í•´ì£¼ì„¸ìš”"})}),N&&e.jsxs("div",{className:"mt-2 text-sm text-red-600",children:["âš ï¸ ",N]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"ğŸ’¡ ì˜ˆì‹œ"}),e.jsx("p",{className:"text-sm text-blue-700",children:'"2ì›” 10ì¼ ë°°ì°¨ìš”ì²­, ë™ì´ì²œì—ì„œ í˜¸ë‚¨ìœ¼ë¡œ, 16íŒ 1ëŒ€, ìƒì˜¨"'}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:'"ë‚´ì¼ ëƒ‰ì¥ 20íŒ”ë ˆíŠ¸, ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ì—ì„œ ë¶€ì‚°ì‹œ í•´ìš´ëŒ€êµ¬ë¡œ"'})]}),e.jsxs("div",{className:"flex gap-3",children:[i?e.jsxs("button",{onClick:f,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"})]}),"ì¤‘ì§€"]}):e.jsxs("button",{onClick:E,disabled:L,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),"ìŒì„± ì…ë ¥ ì‹œì‘"]}),e.jsx("button",{onClick:g,disabled:!n.trim()||L||i,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:L?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ì²˜ë¦¬ ì¤‘..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"ì£¼ë¬¸ ìƒì„±"]})}),e.jsx("button",{onClick:d,disabled:L||i,className:"px-4 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"ì´ˆê¸°í™”",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),e.jsx("div",{className:"mt-4 text-xs text-gray-500 text-center",children:"ğŸ¤ ë§ˆì´í¬ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œ ë§ˆì´í¬ ì‚¬ìš©ì„ í—ˆìš©í•´ì£¼ì„¸ìš”."})]}):e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-yellow-400 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("h3",{className:"text-lg font-medium text-yellow-900 mb-2",children:"ìŒì„± ì¸ì‹ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Chrome ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•˜ì‹œê±°ë‚˜, HTTPS í™˜ê²½ì—ì„œ ì ‘ì†í•´ì£¼ì„¸ìš”."})]})},Ve=t=>{switch(t){case"PENDING":return"bg-yellow-100 text-yellow-800";case"ASSIGNED":return"bg-blue-100 text-blue-800";case"IN_TRANSIT":return"bg-purple-100 text-purple-800";case"DELIVERED":return"bg-green-100 text-green-800";case"CANCELLED":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},He=t=>{switch(t){case"PENDING":return"ëŒ€ê¸°";case"ASSIGNED":return"ë°°ì°¨ì™„ë£Œ";case"IN_TRANSIT":return"ìš´ì†¡ì¤‘";case"DELIVERED":return"ë°°ì†¡ì™„ë£Œ";case"CANCELLED":return"ì·¨ì†Œ";default:return t}},Ze=t=>t==="ëƒ‰ë™"?"text-blue-600":t==="ëƒ‰ì¥"?"text-green-600":"text-orange-600",Ke=({order:t,onSelect:i,isSelected:n=!1})=>e.jsxs("div",{onClick:()=>i&&i(t),className:`
        bg-white rounded-lg border p-4 mb-3 shadow-sm
        ${n?"border-indigo-500 ring-2 ring-indigo-100":"border-gray-200"}
        ${i?"active:bg-gray-50":""}
      `,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:t.order_number}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5",children:t.order_date})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${Ve(t.status)}`,children:He(t.status)})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Y,{size:16,className:"text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"ìƒì°¨"}),e.jsx("div",{className:"text-sm text-gray-900 truncate",children:t.pickup_client_name||t.pickup_address||"ë¯¸ì •"})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Y,{size:16,className:"text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"í•˜ì°¨"}),e.jsx("div",{className:"text-sm text-gray-900 truncate",children:t.delivery_client_name||t.delivery_address||"ë¯¸ì •"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{size:14}),e.jsxs("span",{children:[t.pallet_count,"íŒ"]})]}),e.jsxs("div",{className:`flex items-center gap-1 ${Ze(t.temperature_zone)}`,children:[e.jsx(Ne,{size:14}),e.jsx("span",{children:t.temperature_zone})]}),t.weight_kg&&t.weight_kg>0&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsxs("span",{children:[t.weight_kg,"kg"]})})]}),(t.pickup_start_time||t.delivery_start_time)&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100 flex items-center gap-3 text-xs text-gray-500",children:[t.pickup_start_time&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{size:12}),e.jsxs("span",{children:["ìƒì°¨ ",t.pickup_start_time]})]}),t.delivery_start_time&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{size:12}),e.jsxs("span",{children:["í•˜ì°¨ ",t.delivery_start_time]})]})]})]}),Ot=()=>{const t=ge(),[i,n]=y.useState([]),[l,o]=y.useState(!0),[r,d]=y.useState(""),[_,N]=y.useState("ALL"),[L,b]=y.useState(!1),[E,f]=y.useState(null),[g,w]=y.useState([]),[c,x]=y.useState(!1),[p,a]=y.useState(""),[h,O]=y.useState(""),[m,A]=y.useState(!1),[Z,z]=y.useState(!1),{isMobile:K}=ye();y.useEffect(()=>{$();const s=new Date;a(s.toISOString().split("T")[0]),O(s.toISOString().split("T")[0])},[]);const $=async()=>{var s;try{o(!0);const u=await W.getOrders(),v=u.items||((s=u.data)==null?void 0:s.items)||u.data||[],j=Array.isArray(v)?v:[];n(j),w([])}catch(u){console.error("Failed to fetch orders:",u),C.error("ì£¼ë¬¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤"),n([])}finally{o(!1)}},ne=()=>{g.length===I.length?w([]):w(I.map(s=>s.id))},ce=s=>{g.includes(s)?w(g.filter(u=>u!==s)):w([...g,s])},X=async s=>{if(window.confirm("ì´ ì£¼ë¬¸ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?"))try{await W.deleteOrder(s),C.success("ì£¼ë¬¸ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤"),$()}catch{C.error("ì£¼ë¬¸ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}},de=async()=>{if(g.length===0){C.error("ì‚­ì œí•  ì£¼ë¬¸ì„ ì„ íƒí•´ì£¼ì„¸ìš”");return}if(window.confirm(`ì„ íƒí•œ ${g.length}ê°œì˜ ì£¼ë¬¸ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`))try{await Promise.all(g.map(s=>W.deleteOrder(s))),C.success(`${g.length}ê°œì˜ ì£¼ë¬¸ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤`),$()}catch{C.error("ì¼ê´„ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}},oe=async()=>{try{const u=await(await fetch("/api/v1/orders/template/download")).blob(),v=window.URL.createObjectURL(u),j=document.createElement("a");j.href=v,j.download="orders_template.xlsx",document.body.appendChild(j),j.click(),window.URL.revokeObjectURL(v),document.body.removeChild(j),C.success("ì–‘ì‹ íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤")}catch{C.error("ì–‘ì‹ ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}},me=async()=>{try{const s=new URLSearchParams;_!=="ALL"&&s.append("status",_);const v=await(await fetch(`/api/v1/orders/export/excel?${s.toString()}`)).blob(),j=window.URL.createObjectURL(v),k=document.createElement("a");k.href=j,k.download=`orders_${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(k),k.click(),window.URL.revokeObjectURL(j),document.body.removeChild(k),C.success("ì£¼ë¬¸ ëª©ë¡ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤")}catch{C.error("ë‹¤ìš´ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}},xe=async s=>{var j;const u=(j=s.target.files)==null?void 0:j[0];if(!u)return;const v=new FormData;v.append("file",u);try{x(!0);const k=await fetch("/api/v1/orders/upload",{method:"POST",body:v});if(!k.ok)throw new Error("Upload failed");const M=await k.json();C.success(`${M.created||0}ê°œì˜ ì£¼ë¬¸ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤`),$()}catch{C.error("íŒŒì¼ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤")}finally{x(!1),s.target.value=""}},pe=s=>{const u={PENDING:"bg-yellow-100 text-yellow-800",ASSIGNED:"bg-blue-100 text-blue-800",IN_TRANSIT:"bg-green-100 text-green-800",DELIVERED:"bg-gray-100 text-gray-800",CANCELLED:"bg-red-100 text-red-800"},v={PENDING:"ë°°ì°¨ëŒ€ê¸°",ASSIGNED:"ë°°ì°¨ì™„ë£Œ",IN_TRANSIT:"ìš´ì†¡ì¤‘",DELIVERED:"ë°°ì†¡ì™„ë£Œ",CANCELLED:"ì·¨ì†Œ"};return e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${u[s]}`,children:v[s]||s})},ue=s=>{if(s.status!=="PENDING")return!1;const u=new Date;if(s.pickup_start_time)return new Date(`${s.order_date}T${s.pickup_start_time}`)<u;const v=new Date(s.order_date),j=new Date;return j.setHours(0,0,0,0),v<j},he=(s,u)=>{const v=new Date(s),j=`${v.getMonth()+1}/${v.getDate()}`;if(u){const k=u.substring(0,5);return`${j} ${k}`}return j},I=i.filter(s=>{var k;const u=s.order_number.toLowerCase().includes(r.toLowerCase())||(((k=s.client_name)==null?void 0:k.toLowerCase())||"").includes(r.toLowerCase()),v=_==="ALL"||s.status===_;let j=!0;if(p||h){const M=new Date(s.order_date);p&&h?j=M>=new Date(p)&&M<=new Date(h):p?j=M>=new Date(p):h&&(j=M<=new Date(h))}return u&&v&&j}),J=i.filter(s=>s.status==="PENDING"),R=J.length;return l?e.jsx(Q,{children:e.jsx(je,{})}):e.jsxs(Q,{children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"ì£¼ë¬¸ ê´€ë¦¬"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"ë°°ì†¡ ì£¼ë¬¸ì„ ê´€ë¦¬í•˜ì„¸ìš”"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 md:mt-0",children:[e.jsxs(D,{variant:R>0?"success":"secondary",onClick:()=>{const s=J.map(u=>u.id).join(",");t(`/optimization?order_ids=${s}`)},className:R>0?"animate-pulse":"",disabled:R===0,title:R===0?"ë°°ì°¨ëŒ€ê¸° ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤":"AI ë°°ì°¨ ìµœì í™” í˜ì´ì§€ë¡œ ì´ë™",children:[e.jsx(we,{size:20,className:"mr-2"}),"AI ë°°ì°¨ ",R>0?`(${R}ê±´)`:""]}),e.jsxs(D,{variant:"secondary",onClick:oe,children:[e.jsx(ke,{size:20,className:"mr-2"}),"ì–‘ì‹ ë‹¤ìš´ë¡œë“œ"]}),e.jsxs("label",{children:[e.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:xe,className:"hidden",disabled:c}),e.jsxs(D,{variant:"secondary",as:"span",disabled:c,children:[e.jsx(Ce,{size:20,className:"mr-2"}),c?"ì—…ë¡œë“œ ì¤‘...":"ì—‘ì…€ ì—…ë¡œë“œ"]})]}),e.jsxs(D,{variant:"secondary",onClick:me,children:[e.jsx(Se,{size:20,className:"mr-2"}),"ì „ì²´ ë‹¤ìš´ë¡œë“œ"]}),e.jsxs(D,{variant:"secondary",onClick:()=>A(!0),className:"bg-purple-100 text-purple-700 hover:bg-purple-200",children:[e.jsx(De,{size:20,className:"mr-2"}),"ìì—°ì–´ ì…ë ¥"]}),e.jsxs(D,{variant:"secondary",onClick:()=>z(!0),className:"bg-blue-100 text-blue-700 hover:bg-blue-200",children:[e.jsx(_e,{size:20,className:"mr-2"}),"ìŒì„± ì…ë ¥"]}),e.jsxs(D,{variant:"primary",onClick:()=>{f(null),b(!0)},children:[e.jsx(Le,{size:20,className:"mr-2"}),"ì‹ ê·œ ë“±ë¡"]})]})]}),e.jsxs(P,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"ì£¼ë¬¸ë²ˆí˜¸ ë˜ëŠ” ê±°ë˜ì²˜ëª… ê²€ìƒ‰",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:r,onChange:s=>d(s.target.value)})]})}),e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"date",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:p,onChange:s=>a(s.target.value),placeholder:"ì‹œì‘ì¼"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"date",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:h,onChange:s=>O(s.target.value),placeholder:"ì¢…ë£Œì¼"})]})}),e.jsx("div",{children:e.jsxs("select",{className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",value:_,onChange:s=>N(s.target.value),children:[e.jsx("option",{value:"ALL",children:"ì „ì²´ ìƒíƒœ"}),e.jsx("option",{value:"PENDING",children:"ë°°ì°¨ëŒ€ê¸°"}),e.jsx("option",{value:"ASSIGNED",children:"ë°°ì°¨ì™„ë£Œ"}),e.jsx("option",{value:"IN_TRANSIT",children:"ìš´ì†¡ì¤‘"}),e.jsx("option",{value:"DELIVERED",children:"ë°°ì†¡ì™„ë£Œ"}),e.jsx("option",{value:"CANCELLED",children:"ì·¨ì†Œ"})]})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600",children:p||h?e.jsxs(e.Fragment,{children:[p&&e.jsxs("span",{children:["ì‹œì‘: ",new Date(p).toLocaleDateString("ko-KR")]}),p&&h&&e.jsx("span",{className:"mx-2",children:"~"}),h&&e.jsxs("span",{children:["ì¢…ë£Œ: ",new Date(h).toLocaleDateString("ko-KR")]})]}):e.jsx("span",{children:"ì „ì²´ ê¸°ê°„"})}),e.jsxs(D,{variant:"secondary",size:"sm",onClick:()=>{d(""),N("ALL"),a(""),O("")},children:[e.jsx(Ee,{size:16,className:"mr-2"}),"í•„í„° ì´ˆê¸°í™”"]})]})]}),g.length>0&&e.jsx(P,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[g.length,"ê°œ í•­ëª© ì„ íƒë¨"]}),e.jsxs(D,{variant:"danger",size:"sm",onClick:de,children:[e.jsx(te,{size:16,className:"mr-2"}),"ì„ íƒ í•­ëª© ì‚­ì œ"]})]})}),K?e.jsx("div",{className:"px-4 space-y-3",children:I.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(V,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤"})]}):I.map(s=>e.jsx(Ke,{order:s,onEdit:()=>{f(s),b(!0)},onDelete:()=>X(s.id)},s.id))}):e.jsx(P,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"w-12 py-3 px-4",children:e.jsx("input",{type:"checkbox",checked:I.length>0&&g.length===I.length,onChange:ne,className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"ì£¼ë¬¸ë²ˆí˜¸"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"ìƒì°¨ ë‚ ì§œ/ì‹œê°„"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"ê±°ë˜ì²˜"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"ìƒì°¨ì§€"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"í•˜ì°¨ì§€"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"í™”ë¬¼ìœ í˜•"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"íŒ”ë ˆíŠ¸"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"ìƒíƒœ"}),e.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:"ì‘ì—…"})]})}),e.jsx("tbody",{children:I.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:10,className:"text-center py-8 text-gray-500",children:[e.jsx(V,{size:48,className:"mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"ì£¼ë¬¸ì´ ì—†ìŠµë‹ˆë‹¤"})]})}):I.map(s=>{const u=ue(s);return e.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gray-50 ${u?"bg-red-50":""}`,children:[e.jsx("td",{className:"py-3 px-4",children:e.jsx("input",{type:"checkbox",checked:g.includes(s.id),onChange:()=>ce(s.id),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-blue-600",children:s.order_number}),u&&e.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-700 rounded text-xs font-medium",children:"ì§€ë‚œ ì˜¤ë”"})]})}),e.jsxs("td",{className:"py-3 px-4",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(H,{size:14,className:"text-gray-400"}),e.jsx("span",{children:he(s.order_date,s.pickup_start_time)})]}),s.pickup_start_time&&s.pickup_end_time&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[s.pickup_start_time.substring(0,5)," ~ ",s.pickup_end_time.substring(0,5)]})]}),e.jsx("td",{className:"py-3 px-4",children:s.client_name||s.pickup_client_name||s.delivery_client_name||"-"}),e.jsx("td",{className:"py-3 px-4 max-w-xs truncate",children:s.pickup_address||s.pickup_client_name||"-"}),e.jsx("td",{className:"py-3 px-4 max-w-xs truncate",children:s.delivery_address||s.delivery_client_name||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-sm",children:s.temperature_zone||s.cargo_type||"-"})}),e.jsxs("td",{className:"py-3 px-4",children:[s.pallet_count||0,"ê°œ"]}),e.jsx("td",{className:"py-3 px-4",children:pe(s.status)}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(D,{size:"sm",variant:"secondary",onClick:()=>{f(s),b(!0)},children:[e.jsx(ze,{size:14,className:"mr-1"}),"ìˆ˜ì •"]}),e.jsxs(D,{size:"sm",variant:"danger",onClick:()=>X(s.id),children:[e.jsx(te,{size:14,className:"mr-1"}),"ì‚­ì œ"]})]})})]},s.id)})})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(P,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ì „ì²´ ì£¼ë¬¸"}),e.jsx("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:i.length})]})}),e.jsx(P,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ëŒ€ê¸° ì¤‘"}),e.jsx("p",{className:"text-3xl font-bold text-yellow-600 mt-2",children:i.filter(s=>s.status==="PENDING").length})]})}),e.jsx(P,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ì§„í–‰ ì¤‘"}),e.jsx("p",{className:"text-3xl font-bold text-green-600 mt-2",children:i.filter(s=>s.status==="IN_PROGRESS").length})]})}),e.jsx(P,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"ì™„ë£Œ"}),e.jsx("p",{className:"text-3xl font-bold text-gray-600 mt-2",children:i.filter(s=>s.status==="COMPLETED").length})]})})]})]}),e.jsx(Ie,{isOpen:L,onClose:()=>{b(!1),f(null)},onSuccess:()=>{b(!1),f(null),$(),C.success(E?"ì£¼ë¬¸ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤":"ì£¼ë¬¸ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤")},order:E}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"ğŸ“ ìì—°ì–´ ì£¼ë¬¸ ì…ë ¥"}),e.jsx("button",{onClick:()=>A(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"Ã—"})]}),e.jsx("div",{className:"p-6",children:e.jsx(Ue,{})})]})}),Z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full",children:[e.jsxs("div",{className:"bg-white border-b px-6 py-4 flex items-center justify-between rounded-t-lg",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"ğŸ¤ ìŒì„± ì£¼ë¬¸ ì…ë ¥"}),e.jsx("button",{onClick:()=>z(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"Ã—"})]}),e.jsx("div",{className:"p-6",children:e.jsx(We,{onOrderCreated:()=>{z(!1),$()}})})]})})]})};export{Ot as default};
