#!/bin/bash

echo "================================================================"
echo "ğŸ” í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ WebSocket URL ì²´í¬"
echo "================================================================"
echo ""

echo "1ï¸âƒ£ ì»¨í…Œì´ë„ˆ ë‚´ JavaScript íŒŒì¼ ëª©ë¡:"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
docker exec uvis-frontend ls -lh /usr/share/nginx/html/assets/*.js
echo ""

echo "2ï¸âƒ£ RealtimeDashboardPage ê´€ë ¨ íŒŒì¼:"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
docker exec uvis-frontend ls -lh /usr/share/nginx/html/assets/RealtimeDashboardPage-*.js 2>/dev/null || echo "âŒ íŒŒì¼ ì—†ìŒ"
echo ""

echo "3ï¸âƒ£ ëª¨ë“  JavaScript íŒŒì¼ì—ì„œ WebSocket URL ì¶”ì¶œ:"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
for file in $(docker exec uvis-frontend find /usr/share/nginx/html/assets -name "*.js" -type f 2>/dev/null); do
    echo "íŒŒì¼: $file"
    docker exec uvis-frontend grep -o 'ws[s]*://[^"'"'"']*\|/api/v1/[^"'"'"']*ws[^"'"'"']*' "$file" 2>/dev/null | sort -u | head -10
    echo ""
done
echo ""

echo "4ï¸âƒ£ 'ws/alerts' ë¬¸ìì—´ ê²€ìƒ‰ (ì˜ëª»ëœ ê²½ë¡œ):"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
docker exec uvis-frontend grep -r "ws/alerts" /usr/share/nginx/html/assets/*.js 2>/dev/null | head -5
if [ $? -ne 0 ]; then
    echo "âœ… 'ws/alerts' ì—†ìŒ (ì •ìƒ)"
fi
echo ""

echo "5ï¸âƒ£ 'dispatches/ws' ë¬¸ìì—´ ê²€ìƒ‰ (ì˜¬ë°”ë¥¸ ê²½ë¡œ):"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
docker exec uvis-frontend grep -r "dispatches/ws" /usr/share/nginx/html/assets/*.js 2>/dev/null | head -5
if [ $? -ne 0 ]; then
    echo "âŒ 'dispatches/ws' ì—†ìŒ (ë¬¸ì œ!)"
fi
echo ""

echo "6ï¸âƒ£ index.html ë‚´ìš© í™•ì¸:"
echo "â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
docker exec uvis-frontend head -30 /usr/share/nginx/html/index.html
echo ""

echo "================================================================"
echo "âœ… ì²´í¬ ì™„ë£Œ!"
echo "================================================================"
