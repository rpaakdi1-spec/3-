# í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ê°€ì´ë“œ

## ğŸ¯ ëª©ì 
ì¬ë¬´ ëŒ€ì‹œë³´ë“œì— í‘œì‹œí•  ì²­êµ¬/ì •ì‚° í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

## ğŸ“‹ ìƒì„±ë˜ëŠ” ë°ì´í„°

### 1. ì²­êµ¬ì„œ (Invoices)
- **ê°œìˆ˜**: ê±°ë˜ì²˜ë‹¹ 5-15ê°œ (ì´ 50-150ê°œ ì˜ˆìƒ)
- **ê¸°ê°„**: ìµœê·¼ 3ê°œì›”
- **ìƒíƒœ**:
  - ì´ˆì•ˆ (DRAFT)
  - ë°œì†¡ë¨ (SENT)
  - ê²°ì œ ì™„ë£Œ (PAID)
  - ë¶€ë¶„ ê²°ì œ (PARTIAL)
  - ì—°ì²´ (OVERDUE)
- **ê¸ˆì•¡ ë²”ìœ„**: 500,000ì› ~ 5,000,000ì›
- **í¬í•¨ í•­ëª©**:
  - ì²­êµ¬ì„œ ê¸°ë³¸ ì •ë³´ (ë²ˆí˜¸, ê±°ë˜ì²˜, ê¸°ê°„, ê¸ˆì•¡)
  - ì²­êµ¬ì„œ í•­ëª© (ë°°ì†¡ ì„œë¹„ìŠ¤ ìƒì„¸)
  - ì„¸ê¸ˆ ë° í• ì¸ ì •ë³´

### 2. ê²°ì œ ê¸°ë¡ (Payments)
- ê²°ì œ ì™„ë£Œ ë˜ëŠ” ë¶€ë¶„ ê²°ì œëœ ì²­êµ¬ì„œì— ìë™ ìƒì„±
- ê²°ì œ ë°©ë²•: í˜„ê¸ˆ, ê³„ì¢Œì´ì²´, ì‹ ìš©ì¹´ë“œ, ìˆ˜í‘œ
- ê±°ë˜ ì°¸ì¡° ë²ˆí˜¸ ë° ì€í–‰ ì •ë³´ í¬í•¨

### 3. ê¸°ì‚¬ ì •ì‚° (Driver Settlements)
- **ê°œìˆ˜**: ê¸°ì‚¬ë‹¹ 3-8ê°œ
- **ê¸°ê°„**: ìµœê·¼ 3ê°œì›”
- **í¬í•¨ ì •ë³´**:
  - ì´ ë§¤ì¶œ, ìˆ˜ìˆ˜ë£Œ, ë¹„ìš©, ìˆœì•¡
  - ë°°ì°¨ ê±´ìˆ˜, ì´ ê±°ë¦¬, íŒ”ë ˆíŠ¸ ìˆ˜
  - ì •ì‚° í•­ëª© (ë°°ì°¨ë³„ ìƒì„¸ ë‚´ì—­)

### 4. ê±°ë˜ì²˜ (Clients)
- ê¸°ì¡´ ê±°ë˜ì²˜ê°€ ì—†ìœ¼ë©´ 10ê°œì˜ í…ŒìŠ¤íŠ¸ ê±°ë˜ì²˜ ìë™ ìƒì„±
- ì‚¬ì—…ìë²ˆí˜¸, ë‹´ë‹¹ì, ì—°ë½ì²˜ ì •ë³´ í¬í•¨

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ë°©ë²• 1: ì„œë²„ì—ì„œ ì§ì ‘ ì‹¤í–‰ (ê¶Œì¥)

```bash
# 1. ì„œë²„ ì ‘ì†
ssh root@139.150.11.99

# 2. í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /root/uvis

# 3. ìµœì‹  ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
git pull origin genspark_ai_developer

# 4. Docker ì»¨í…Œì´ë„ˆì—ì„œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
docker exec -it uvis-backend python /app/scripts/generate_billing_test_data.py

# 5. ê²°ê³¼ í™•ì¸
# ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ í›„ ìƒì„±ëœ ë°ì´í„° í†µê³„ê°€ í‘œì‹œë©ë‹ˆë‹¤
```

### ë°©ë²• 2: ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ì‹¤í–‰

```bash
# 1. ë°±ì—”ë“œ ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it uvis-backend bash

# 2. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
cd /app
python scripts/generate_billing_test_data.py

# 3. ì¢…ë£Œ
exit
```

## ğŸ“Š ì‹¤í–‰ ê²°ê³¼ ì˜ˆì‹œ

```
============================================================
ì²­êµ¬/ì •ì‚° í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ì‹œì‘
============================================================

ğŸ“Š ê¸°ì¡´ ë°ì´í„° í˜„í™©:
   - ì²­êµ¬ì„œ: 0ê°œ
   - ì •ì‚°: 0ê°œ

ğŸ“‹ ë§ˆìŠ¤í„° ë°ì´í„° í˜„í™©:
   - ê±°ë˜ì²˜: 10ê°œ
   - ê¸°ì‚¬: 5ê°œ
   - ë°°ì°¨: 100ê°œ

ğŸ“ ì²­êµ¬ì„œ ìƒì„± ì¤‘...
   âœ… 85ê°œì˜ ì²­êµ¬ì„œ ìƒì„± ì™„ë£Œ

ğŸ’° ê¸°ì‚¬ ì •ì‚° ìƒì„± ì¤‘...
   âœ… 25ê°œì˜ ì •ì‚° ìƒì„± ì™„ë£Œ

============================================================
âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ì™„ë£Œ!
============================================================

ğŸ“Š ìƒì„±ëœ ë°ì´í„°:
   - ì´ ì²­êµ¬ì„œ: 85ê°œ
     â”œâ”€ ì´ˆì•ˆ: 15ê°œ
     â”œâ”€ ë°œì†¡ë¨: 18ê°œ
     â”œâ”€ ê²°ì œ ì™„ë£Œ: 22ê°œ
     â”œâ”€ ë¶€ë¶„ ê²°ì œ: 17ê°œ
     â””â”€ ì—°ì²´: 13ê°œ
   - ì´ ê²°ì œ ê¸°ë¡: 39ê°œ
   - ì´ ì •ì‚°: 25ê°œ

ğŸ’° ê¸ˆì•¡ í†µê³„:
   - ì´ ì²­êµ¬ ê¸ˆì•¡: â‚©185,420,350
   - ì´ ìˆ˜ê¸ˆ ê¸ˆì•¡: â‚©98,750,280
   - ìˆ˜ê¸ˆë¥ : 53.2%
   - ì´ ì •ì‚° ê¸ˆì•¡: â‚©42,380,500

ğŸ¯ ë‹¤ìŒ ë‹¨ê³„:
   1. ë¸Œë¼ìš°ì €ì—ì„œ http://139.150.11.99 ì ‘ì†
   2. admin/admin123 ë¡œê·¸ì¸
   3. ì²­êµ¬/ì •ì‚° > ì¬ë¬´ ëŒ€ì‹œë³´ë“œ í™•ì¸
   4. ë„¤íŠ¸ì›Œí¬ íƒ­ì—ì„œ API ì‘ë‹µ í™•ì¸
============================================================
```

## âœ… ê²€ì¦ ë°©ë²•

### 1. ë°ì´í„°ë² ì´ìŠ¤ í™•ì¸

```bash
# PostgreSQL ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it uvis-postgres psql -U uvis_user -d uvis_db

# ì²­êµ¬ì„œ ê°œìˆ˜ í™•ì¸
SELECT COUNT(*) FROM invoices;

# ì²­êµ¬ì„œ ìƒíƒœë³„ ê°œìˆ˜
SELECT status, COUNT(*) FROM invoices GROUP BY status;

# ì´ ì²­êµ¬ ê¸ˆì•¡
SELECT SUM(total_amount) FROM invoices;

# ì •ì‚° ê°œìˆ˜ í™•ì¸
SELECT COUNT(*) FROM driver_settlements;

# ì¢…ë£Œ
\q
```

### 2. API í…ŒìŠ¤íŠ¸

```bash
# ë¡œê·¸ì¸í•˜ì—¬ í† í° íšë“
TOKEN=$(curl -X POST "http://139.150.11.99/api/v1/auth/login" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin&password=admin123" \
  | jq -r '.access_token')

# ì¬ë¬´ ëŒ€ì‹œë³´ë“œ API í˜¸ì¶œ
curl -X GET "http://139.150.11.99/api/v1/billing/enhanced/dashboard/financial?start_date=2025-11-12&end_date=2026-02-12" \
  -H "Authorization: Bearer $TOKEN" \
  | jq
```

### 3. ì›¹ UI í™•ì¸

1. **ë¸Œë¼ìš°ì € ì ‘ì†**: http://139.150.11.99
2. **ë¡œê·¸ì¸**: admin / admin123
3. **ë©”ë‰´ ì´ë™**: ì²­êµ¬/ì •ì‚° > ì¬ë¬´ ëŒ€ì‹œë³´ë“œ
4. **í™•ì¸ ì‚¬í•­**:
   - âœ… 4ê°œì˜ ìš”ì•½ ì¹´ë“œì— ìˆ«ì í‘œì‹œ
   - âœ… ì›”ë³„ ë§¤ì¶œ ì¶”ì´ ì°¨íŠ¸ì— ë°ì´í„° í‘œì‹œ
   - âœ… ì›”ë³„ ìˆ˜ìµ ë¶„ì„ ì°¨íŠ¸ì— ë°ì´í„° í‘œì‹œ
   - âœ… TOP 10 ê±°ë˜ì²˜ í…Œì´ë¸”ì— ë°ì´í„° í‘œì‹œ

### 4. Network íƒ­ í™•ì¸

**DevTools > Network > Filter: billing**

3ê°œì˜ API ìš”ì²­ì´ ëª¨ë‘ 200 OK:
- `GET /api/v1/billing/enhanced/dashboard/financial` âœ…
- `GET /api/v1/billing/enhanced/dashboard/trends` âœ…
- `GET /api/v1/billing/enhanced/dashboard/top-clients` âœ…

## âš ï¸ ì£¼ì˜ì‚¬í•­

### 1. ê¸°ì¡´ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°
ìŠ¤í¬ë¦½íŠ¸ëŠ” ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì§€ ì•Šê³  ì¶”ê°€ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
ê¸°ì¡´ ë°ì´í„°ê°€ ìˆìœ¼ë©´ í™•ì¸ ë©”ì‹œì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.

### 2. ë°ì´í„° ì‚­ì œ ë°©ë²•

```bash
# í…ŒìŠ¤íŠ¸ ë°ì´í„°ë§Œ ì‚­ì œí•˜ê³  ì‹¶ì€ ê²½ìš°
docker exec -it uvis-postgres psql -U uvis_user -d uvis_db

# ì²­êµ¬ì„œ ë°ì´í„° ì‚­ì œ (CASCADEë¡œ ê´€ë ¨ ë°ì´í„° ëª¨ë‘ ì‚­ì œ)
DELETE FROM invoices WHERE invoice_number LIKE 'INV-2026-%';

# ì •ì‚° ë°ì´í„° ì‚­ì œ
DELETE FROM driver_settlements WHERE settlement_number LIKE 'STL-2026-%';

# í…ŒìŠ¤íŠ¸ ê±°ë˜ì²˜ ì‚­ì œ (í•„ìš”ì‹œ)
DELETE FROM clients WHERE client_code LIKE 'CLI%' AND name LIKE 'í…ŒìŠ¤íŠ¸ ê±°ë˜ì²˜%';

\q
```

### 3. í”„ë¡œë•ì…˜ í™˜ê²½ ì£¼ì˜
- í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©
- ì‹¤ì œ ë°ì´í„°ì™€ êµ¬ë¶„í•  ìˆ˜ ìˆë„ë¡ ë²ˆí˜¸ íŒ¨í„´ í™•ì¸
- í•„ìš”ì‹œ ë³„ë„ì˜ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš© ê¶Œì¥

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜

```bash
# ì—ëŸ¬: No module named 'app'
# í•´ê²°: ì˜¬ë°”ë¥¸ ê²½ë¡œì—ì„œ ì‹¤í–‰
cd /app
python scripts/generate_billing_test_data.py
```

### ë¬¸ì œ 2: ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì˜¤ë¥˜

```bash
# ë°±ì—”ë“œ ì»¨í…Œì´ë„ˆ ë¡œê·¸ í™•ì¸
docker logs uvis-backend --tail 50

# ë°ì´í„°ë² ì´ìŠ¤ ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker ps | grep postgres
```

### ë¬¸ì œ 3: ìƒì„±ëœ ë°ì´í„°ê°€ ëŒ€ì‹œë³´ë“œì— í‘œì‹œë˜ì§€ ì•ŠìŒ

```bash
# 1. API ì‘ë‹µ í™•ì¸
curl -X GET "http://139.150.11.99/api/v1/billing/enhanced/dashboard/financial" \
  -H "Authorization: Bearer $TOKEN" | jq

# 2. ë‚ ì§œ ë²”ìœ„ í™•ì¸ (ìµœê·¼ 3ê°œì›” ë°ì´í„°ë§Œ ìƒì„±ë¨)
# start_dateë¥¼ 3ê°œì›” ì „ìœ¼ë¡œ ì„¤ì •

# 3. ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ í›„ ì¬ë¡œë“œ
# Ctrl+Shift+R (Chrome)
```

## ğŸ“š ê´€ë ¨ íŒŒì¼

- **ìŠ¤í¬ë¦½íŠ¸**: `backend/scripts/generate_billing_test_data.py`
- **ëª¨ë¸**: 
  - `backend/app/models/billing.py`
  - `backend/app/models/billing_enhanced.py`
- **API**: `backend/app/api/v1/billing_enhanced.py`
- **í”„ë¡ íŠ¸ì—”ë“œ**: `frontend/src/pages/FinancialDashboardPage.tsx`

## ğŸ”— ì°¸ê³  ë§í¬

- **GitHub ì»¤ë°‹**: https://github.com/rpaakdi1-spec/3-/commit/5887b82
- **ì´ì „ ì»¤ë°‹ë“¤**:
  - 6b5e90d - fix: Remove debugAuth check
  - d29e9d1 - refactor: API centralization
  - 7e618ba - docs: Update TODO.md

## ğŸ“ ì§€ì›

ë¬¸ì œê°€ ë°œìƒí•˜ë©´:
1. ìœ„ì˜ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì„¹ì…˜ í™•ì¸
2. ë°±ì—”ë“œ ë¡œê·¸ í™•ì¸: `docker logs uvis-backend`
3. ë°ì´í„°ë² ì´ìŠ¤ ì§ì ‘ í™•ì¸
4. GitHub Issuesì— ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ í¬í•¨í•˜ì—¬ ë¬¸ì˜
